<!DOCTYPE html>

<html lang="fr" data-theme="dark">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>MOT MYSTÃˆRE v3 ğŸ”®</title>
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700;800;900&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<style>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
THÃˆME â€” data-theme sur <html>
CSS variables qui marchent vraiment
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
[data-theme="dark"] {
--bg: #0e0e0e;
--s1: #1c1c1c;
--s2: #272727;
--s3: #333;
--border: rgba(255,255,255,0.09);
--txt: #f0f0f0;
--txt2: #999;
--txt3: #555;
--overlay: rgba(0,0,0,0.88);
}
[data-theme="light"] {
--bg: #f2f2f2;
--s1: #ffffff;
--s2: #ebebeb;
--s3: #ddd;
--border: rgba(0,0,0,0.09);
--txt: #111;
--txt2: #666;
--txt3: #aaa;
--overlay: rgba(0,0,0,0.55);
}
/* Accents fixes */
:root {
--pk: #fe2c55;
--cy: #25f4ee;
--gd: #ffd700;
--gr: #1db954;
--pu: #a855f7;
--or: #ff8c00;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
RESET & BASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
*,*::before,*::after { margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent; }
html { height:100%; }
body {
background: var(â€“bg);
color: var(â€“txt);
font-family: â€˜Nunitoâ€™, sans-serif;
min-height: 100vh;
overflow-x: hidden;
/* transition pour le switch de thÃ¨me */
transition: background .25s, color .25s;
}

/* TikTok grid bg */
body::before {
content: â€˜â€™;
position: fixed; inset: 0; z-index: 0; pointer-events: none;
background-image:
linear-gradient(var(â€“border) 1px, transparent 1px),
linear-gradient(90deg, var(â€“border) 1px, transparent 1px);
background-size: 30px 30px;
}
/* Blobs */
.blob { position:fixed;border-radius:50%;filter:blur(90px);pointer-events:none;z-index:0; }
.b1 { width:380px;height:380px;background:var(â€“pk);opacity:.1;top:-120px;right:-80px; }
.b2 { width:320px;height:320px;background:var(â€“cy);opacity:.08;bottom:-80px;left:-60px; }
[data-theme=â€œlightâ€] .b1 { opacity:.05; }
[data-theme=â€œlightâ€] .b2 { opacity:.04; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LAYOUT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.app {
position: relative; z-index: 1;
min-height: 100vh;
display: flex; flex-direction: column;
align-items: center; justify-content: center;
padding: 76px 14px 40px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TOPBAR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#topbar {
position: fixed; top:0; left:0; right:0; z-index:200;
display: flex; align-items: center; justify-content: space-between;
padding: 10px 14px;
background: var(â€“bg);
border-bottom: 1px solid var(â€“border);
backdrop-filter: blur(14px);
transition: background .25s;
}
.topbar-logo {
font-family: â€˜Space Monoâ€™, monospace;
font-size: 13px; font-weight: 700; letter-spacing: 1px;
background: linear-gradient(90deg, var(â€“pk), var(â€“cy));
-webkit-background-clip: text; -webkit-text-fill-color: transparent;
background-clip: text;
}
.topbar-btns { display:flex; gap:8px; align-items:center; }

/* Petits boutons topbar */
.tbtn {
background: var(â€“s2); border: 1px solid var(â€“border);
border-radius: 50px; padding: 6px 13px;
font-size: 12px; font-weight: 800; cursor: pointer;
font-family: â€˜Nunitoâ€™, sans-serif; color: var(â€“txt2);
display: flex; align-items: center; gap: 5px;
transition: all .2s; white-space: nowrap;
}
.tbtn:hover { color: var(â€“txt); border-color: var(â€“pk); }
#back-btn { display: none; }
#back-btn.vis { display: flex; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SCREENS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.sc { display:none; width:100%; max-width:430px; flex-direction:column; align-items:center; gap:12px; }
.sc.on { display:flex; animation: fadeUp .38s ease; }
@keyframes fadeUp { from{opacity:0;transform:translateY(16px)} to{opacity:1;transform:translateY(0)} }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LOGO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.logo { text-align: center; padding: 4px 0; }
.logo-em { font-size: 54px; display: block; animation: fl 3s ease-in-out infinite; }
@keyframes fl { 0%,100%{transform:translateY(0)} 50%{transform:translateY(-8px)} }
.logo-name {
font-family: â€˜Space Monoâ€™, monospace; font-weight: 700;
font-size: clamp(24px,8vw,40px); letter-spacing: 2px; text-transform: uppercase;
background: linear-gradient(135deg, var(â€“pk), var(â€“cy), var(â€“gd));
-webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
line-height: 1.1; margin-top: 4px;
}
.logo-sub { font-size: 11px; letter-spacing: 3px; color: var(â€“txt3); margin-top: 6px; font-weight: 700; text-transform: uppercase; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.card {
background: var(â€“s1); border: 1px solid var(â€“border);
border-radius: 18px; padding: 20px 18px;
width: 100%; position: relative; overflow: hidden;
transition: background .25s, border-color .25s;
}
.card-pk { border-top: 3px solid var(â€“pk); }
.card-cy { border-top: 3px solid var(â€“cy); }
.card-gd { border-top: 3px solid var(â€“gd); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LABELS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.lbl {
display: block;
font-family: â€˜Space Monoâ€™, monospace;
font-size: 9px; letter-spacing: 3px; text-transform: uppercase;
color: var(â€“txt3); margin-bottom: 7px; font-weight: 700;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
INPUTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.inp {
width: 100%; padding: 13px 15px;
background: var(â€“s2); border: 1.5px solid var(â€“border); border-radius: 12px;
color: var(â€“txt); font-family: â€˜Nunitoâ€™, sans-serif; font-size: 15px; font-weight: 700;
outline: none; transition: border-color .2s, box-shadow .2s, background .25s;
}
.inp:focus { border-color: var(â€“pk); box-shadow: 0 0 0 3px rgba(254,44,85,.1); }
.inp::placeholder { color: var(â€“txt3); font-weight: 400; }

.inp-code {
width: 100%; padding: 14px;
text-align: center; letter-spacing: 10px; font-size: 30px; font-weight: 700;
font-family: â€˜Space Monoâ€™, monospace; color: var(â€“gd);
background: var(â€“s2); border: 2px solid var(â€“border); border-radius: 12px;
outline: none; transition: border-color .2s, background .25s;
}
.inp-code:focus { border-color: var(â€“gd); }
.inp-code::placeholder { letter-spacing: 4px; font-size: 14px; color: var(â€“txt3); }

.sel {
width: 100%; padding: 13px 40px 13px 15px;
background: var(â€“s2); border: 1.5px solid var(â€“border); border-radius: 12px;
color: var(â€“txt); font-family: â€˜Nunitoâ€™, sans-serif; font-size: 14px; font-weight: 700;
outline: none; cursor: pointer; appearance: none; -webkit-appearance: none;
background-image: url(â€œdata:image/svg+xml,%3Csvg xmlns=â€˜http://www.w3.org/2000/svgâ€™ width=â€˜12â€™ height=â€˜8â€™%3E%3Cpath d=â€˜M1 1l5 5 5-5â€™ stroke=â€™%23888â€™ stroke-width=â€˜2â€™ fill=â€˜noneâ€™ stroke-linecap=â€˜roundâ€™/%3E%3C/svg%3Eâ€);
background-repeat: no-repeat; background-position: right 14px center;
transition: background .25s, border-color .2s;
}
.sel option { background: var(â€“s1); }

.inp-guess {
flex: 1; padding: 13px 14px;
font-family: â€˜Space Monoâ€™, monospace; font-size: 20px; font-weight: 700;
letter-spacing: 3px; text-align: center; text-transform: uppercase;
background: var(â€“s2); border: 2px solid var(â€“border); border-radius: 14px;
color: var(â€“txt); outline: none; transition: border-color .2s, box-shadow .2s, background .25s;
}
.inp-guess:focus { border-color: var(â€“gd); box-shadow: 0 0 0 3px rgba(255,215,0,.1); }
.inp-guess::placeholder { color: var(â€“txt3); font-size: 12px; letter-spacing: 2px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
BUTTONS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.btn {
display: flex; align-items: center; justify-content: center; gap: 8px;
padding: 15px 20px; border-radius: 50px; border: none;
font-family: â€˜Nunitoâ€™, sans-serif; font-weight: 900; font-size: 15px;
cursor: pointer; transition: all .18s; width: 100%; letter-spacing: .3px;
}
.btn:active { transform: scale(.96); }
.btn:disabled { opacity: .3; cursor: not-allowed; }

.b-pk { background: linear-gradient(135deg,#fe2c55,#ff6b6b); color:#fff; box-shadow:0 4px 20px rgba(254,44,85,.35); }
.b-pk:hover { box-shadow:0 6px 28px rgba(254,44,85,.55); transform:translateY(-1px); }
.b-cy { background: linear-gradient(135deg,#0cc,var(â€“cy)); color:#0a0a0a; box-shadow:0 4px 20px rgba(37,244,238,.25); }
.b-cy:hover { box-shadow:0 6px 28px rgba(37,244,238,.45); transform:translateY(-1px); }
.b-gd { background: linear-gradient(135deg,#e6c200,#ffd700,#ffe84d); color:#0a0a0a; box-shadow:0 4px 20px rgba(255,215,0,.3); }
.b-gd:hover { box-shadow:0 6px 28px rgba(255,215,0,.5); transform:translateY(-1px); }
.b-gh { background:var(â€“s2); color:var(â€“txt2); border:1.5px solid var(â€“border); }
.b-gh:hover { color:var(â€“txt); border-color:var(â€“txt3); }
.b-sm { padding:10px 18px; font-size:13px; border-radius:50px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PILLS / BADGES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.pill {
display: inline-flex; align-items: center; gap: 4px;
padding: 4px 11px; border-radius: 50px;
font-size: 10px; font-weight: 800; letter-spacing: .5px; text-transform: uppercase;
}
.p-pk { background:rgba(254,44,85,.12); color:var(â€“pk); border:1px solid rgba(254,44,85,.2); }
.p-cy { background:rgba(37,244,238,.1); color:var(â€“cy); border:1px solid rgba(37,244,238,.18); }
.p-gd { background:rgba(255,215,0,.1); color:var(â€“gd); border:1px solid rgba(255,215,0,.18); }
.p-gr { background:rgba(29,185,84,.1); color:var(â€“gr); border:1px solid rgba(29,185,84,.18); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CODE BOX
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.codebox {
background: var(â€“s2); border: 2px solid rgba(255,215,0,.25);
border-radius: 16px; padding: 16px; text-align: center; width: 100%;
transition: background .25s;
}
#l-code {
display: block;
font-family: â€˜Space Monoâ€™, monospace; font-size: 42px; font-weight: 700;
letter-spacing: 12px; color: var(â€“gd); padding: 4px 0;
text-shadow: 0 0 24px rgba(255,215,0,.4);
}
.copyhint { font-size: 10px; color: var(â€“txt3); cursor: pointer; margin-top: 5px; letter-spacing: 2px; font-weight: 700; transition: color .2s; }
.copyhint:hover { color: var(â€“cy); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DIFFICULTY TILES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.diff-row { display: grid; grid-template-columns: repeat(3,1fr); gap: 8px; width:100%; }
.dtile {
padding: 12px 6px; border-radius: 12px; border: 2px solid var(â€“border);
background: var(â€“s2); cursor: pointer; text-align: center;
transition: all .18s; user-select: none;
}
.dtile * { pointer-events: none; }
.dtile .di { font-size: 22px; display: block; margin-bottom: 3px; }
.dtile .dn { font-size: 10px; font-weight: 900; display: block; }
.dtile.on-e { border-color:var(â€“gr); background:rgba(29,185,84,.08); }
.dtile.on-m { border-color:var(â€“gd); background:rgba(255,215,0,.08); }
.dtile.on-h { border-color:var(â€“pk); background:rgba(254,44,85,.08); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CATEGORY CHIPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.chips { display:flex; flex-wrap:wrap; gap:6px; width:100%; }
.chip {
padding: 6px 12px; border-radius: 50px; border: 1.5px solid var(â€“border);
background: var(â€“s2); cursor: pointer; font-size: 11px; font-weight: 800;
transition: all .18s; user-select: none; color: var(â€“txt2);
}
.chip * { pointer-events: none; }
.chip.on { border-color: var(â€“pk); color: var(â€“pk); background: rgba(254,44,85,.08); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
PLAYER ROWS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.plist { display:flex; flex-direction:column; gap:6px; width:100%; }
.prow {
display: flex; align-items: center; gap: 10px;
padding: 11px 14px; background: var(â€“s2);
border-radius: 12px; border: 1.5px solid var(â€“border);
transition: background .25s, border-color .2s;
}
.prow.me { border-color: rgba(254,44,85,.3); }
.prow.host { border-color: rgba(37,244,238,.3); }
.pav { width:36px; height:36px; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:18px; flex-shrink:0; }
.pnm { font-weight: 800; font-size: 13px; flex:1; }
.pscore { font-family:â€˜Space Monoâ€™,monospace; font-size:12px; color:var(â€“gd); font-weight:700; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
GAME HEADER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.game-hdr {
display: flex; justify-content: space-between; align-items: center;
width: 100%; padding: 0 2px; margin-bottom: 2px;
}
.round-txt { font-family:â€˜Space Monoâ€™,monospace; font-size:9px; color:var(â€“txt3); letter-spacing:2px; font-weight:700; }
.round-num { font-family:â€˜Space Monoâ€™,monospace; font-size:16px; font-weight:700; color:var(â€“txt); }
.master-txt { font-family:â€˜Space Monoâ€™,monospace; font-size:9px; color:var(â€“txt3); letter-spacing:1px; font-weight:700; text-align:right; }
.master-nm { font-family:â€˜Space Monoâ€™,monospace; font-size:11px; color:var(â€“cy); font-weight:700; text-align:right; }

/* Timer ring */
.timer-ring { position:relative; width:46px; height:46px; flex-shrink:0; }
.timer-ring svg { transform:rotate(-90deg); }
.timer-ring circle { stroke-dasharray:126; stroke-dashoffset:0; transition:stroke-dashoffset 1s linear, stroke .4s; }
#timer-txt {
position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
font-family:â€˜Space Monoâ€™,monospace; font-size:13px; font-weight:700; color:var(â€“cy);
}

/* Progress */
.progbar { height:3px; background:var(â€“s3); border-radius:4px; overflow:hidden; width:100%; transition:background .25s; }
.progfill { height:100%; background:linear-gradient(90deg,var(â€“pk),var(â€“cy)); border-radius:4px; transition:width .6s ease; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ROLE BADGE (visible au lancement manche)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.role-badge {
display: flex; align-items: center; justify-content: center; gap: 10px;
padding: 12px 16px; border-radius: 14px; width: 100%;
font-weight: 900; font-size: 14px; letter-spacing: .5px;
animation: fadeUp .4s ease;
}
.role-master { background:rgba(37,244,238,.1); border:2px solid rgba(37,244,238,.3); color:var(â€“cy); }
.role-guesser { background:rgba(255,215,0,.08); border:2px solid rgba(255,215,0,.2); color:var(â€“gd); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
MASTER ZONE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.master-zone {
background: linear-gradient(135deg,rgba(37,244,238,.05),rgba(168,85,247,.05));
border: 2px solid rgba(37,244,238,.2); border-radius: 18px;
padding: 18px 16px; width: 100%;
transition: background .25s, border-color .2s;
}
.master-lbl { font-family:â€˜Space Monoâ€™,monospace; font-size:9px; letter-spacing:3px; color:var(â€“cy); text-transform:uppercase; text-align:center; margin-bottom:10px; font-weight:700; }
.master-word-big {
font-family: â€˜Space Monoâ€™, monospace;
font-size: clamp(22px,7vw,34px); font-weight: 700;
letter-spacing: 5px; text-align: center; text-transform: uppercase;
color: var(â€“cy); text-shadow: 0 0 20px rgba(37,244,238,.35);
padding: 14px 10px; background: var(â€“s2); border-radius: 12px; margin: 8px 0 14px;
transition: background .25s;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
WORD ZONE (devineurs)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.word-zone {
background: var(â€“s1); border: 1.5px solid var(â€“border);
border-radius: 18px; padding: 18px 16px; width: 100%;
position: relative; overflow: hidden;
transition: background .25s, border-color .2s;
}
.word-zone::before {
content:â€™â€™; position:absolute; top:0; left:0; right:0; height:3px;
background: linear-gradient(90deg, var(â€“pk), var(â€“cy), var(â€“gd));
}
.wz-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:14px; }
.blanks { display:flex; flex-wrap:wrap; gap:5px; justify-content:center; margin:10px 0 12px; }
.blank {
width: 28px; height: 34px; border-bottom: 2.5px solid var(â€“txt3);
display: flex; align-items: flex-end; justify-content: center; padding-bottom:3px;
font-family: â€˜Space Monoâ€™, monospace; font-size:17px; font-weight:700;
transition: all .3s; color: var(â€“txt);
}
.blank.lit { border-color:var(â€“cy); color:var(â€“cy); animation:popL .4s cubic-bezier(.34,1.56,.64,1); }
.blank.space { width:12px; border:none; }
@keyframes popL { 0%{transform:scale(0)} 70%{transform:scale(1.3)} 100%{transform:scale(1)} }
.word-info { font-family:â€˜Space Monoâ€™,monospace; font-size:10px; color:var(â€“txt3); text-align:center; letter-spacing:1px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
HINTS LIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.hints-list { display:flex; flex-direction:column; gap:5px; width:100%; }
.hint-item {
display: flex; align-items: flex-start; gap: 8px;
padding: 9px 12px; background: var(â€“s2); border-radius: 10px;
border: 1px solid var(â€“border); animation: fadeUp .3s ease;
transition: background .25s, border-color .2s;
}
.hint-num {
font-family:â€˜Space Monoâ€™,monospace; font-size:9px; font-weight:700;
color:var(â€“cy); background:rgba(37,244,238,.1); padding:2px 6px;
border-radius:4px; letter-spacing:1px; flex-shrink:0; margin-top:2px;
}
.hint-txt { font-size:13px; line-height:1.5; flex:1; font-weight:700; }
.hint-by { font-size:10px; color:var(â€“txt3); margin-top:2px; font-weight:400; }
.no-hint {
padding: 20px; text-align:center; font-size:11px; color:var(â€“txt3);
font-weight:700; letter-spacing:2px; border:1.5px dashed var(â€“border); border-radius:10px;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
GUESS FEED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.guess-feed { display:flex; flex-direction:column; gap:5px; max-height:160px; overflow-y:auto; }
.guess-item {
display: flex; align-items: center; justify-content: space-between;
padding: 8px 12px; background: var(â€“s2); border-radius: 10px;
border: 1.5px solid var(â€“border); animation: fadeUp .25s ease;
transition: background .25s;
}
.guess-item.correct { border-color:var(â€“gr); background:rgba(29,185,84,.07); }
.guess-item.close { border-color:var(â€“gd); background:rgba(255,215,0,.06); }
.gw { font-family:â€˜Space Monoâ€™,monospace; font-size:11px; letter-spacing:1px; font-weight:700; }
.gn { font-weight:800; font-size:12px; }
.gr-icon { font-size:15px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
GUESS INPUT ROW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.guess-row { display:flex; gap:8px; width:100%; align-items:stretch; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FOUND BANNER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.found-banner {
display: none; padding: 13px; border-radius: 12px; text-align: center;
background: rgba(29,185,84,.1); border: 2px solid var(â€“gr);
font-weight: 900; font-size: 13px; color: var(â€“gr);
}
.found-banner.on { display:block; animation:fadeUp .4s ease; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
RÃ‰SULTAT MANCHE â€” bottom sheet TikTok
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#result-overlay {
position: fixed; inset:0; z-index:500;
display: none; align-items:flex-end; justify-content:center;
padding: 0 14px 20px;
}
#result-overlay.show { display: flex; }
#result-overlay::before {
content:â€™â€™; position:fixed; inset:0;
background: var(â€“overlay); backdrop-filter:blur(6px); z-index:-1;
}
.result-sheet {
background: var(â€“s1); border:1.5px solid var(â€“border);
border-radius: 24px 24px 20px 20px;
padding: 22px 20px 20px; width:100%; max-width:430px;
animation: slideUp .4s cubic-bezier(.34,1.2,.64,1);
transition: background .25s;
}
@keyframes slideUp { from{transform:translateY(100%)} to{transform:translateY(0)} }
.sheet-handle { width:40px; height:4px; background:var(â€“s3); border-radius:4px; margin:0 auto 16px; }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
SCORE ROWS (fin de partie)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.score-row {
display: flex; align-items:center; gap:12px;
padding: 12px 14px; background: var(â€“s2);
border-radius: 12px; border:1.5px solid var(â€“border); margin-bottom:6px;
transition: background .25s;
}
.s-rank { font-size:20px; width:28px; text-align:center; }
.s-name { font-weight:800; flex:1; font-size:13px; }
.s-pts { font-family:â€˜Space Monoâ€™,monospace; font-size:15px; font-weight:700; color:var(â€“gd); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TOAST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
#toast {
position: fixed; bottom:20px; left:50%;
transform: translateX(-50%) translateY(80px);
background: var(â€“s1); border:1.5px solid var(â€“border);
border-radius: 50px; padding:11px 22px;
font-weight:800; font-size:13px; z-index:9999;
transition: transform .35s cubic-bezier(.34,1.56,.64,1), background .25s;
white-space:nowrap; max-width:90vw; text-align:center;
pointer-events:none; color:var(â€“txt);
box-shadow: 0 8px 32px rgba(0,0,0,.25);
}
#toast.up { transform: translateX(-50%) translateY(0); }
#toast.ok { border-color: var(â€“gr); }
#toast.er { border-color: var(â€“pk); }
#toast.if { border-color: var(â€“cy); }
#toast.gd { border-color: var(â€“gd); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
UTILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
.col { display:flex; flex-direction:column; gap:10px; width:100%; }
.row { display:flex; gap:8px; align-items:center; }
.tc { text-align:center; } .w100 { width:100%; }
.mt4{margin-top:4px;} .mt8{margin-top:8px;} .mt12{margin-top:12px;}
.bold { font-weight:900; } .sm { font-size:13px; font-weight:700; } .xs { font-size:11px; }
.muted { color:var(â€“txt2); }
.shk { animation:shk .35s ease; }
@keyframes shk { 0%,100%{transform:translateX(0)} 25%{transform:translateX(-8px)} 75%{transform:translateX(8px)} }
@keyframes confY { to{transform:translateY(110vh) rotate(720deg);opacity:0} }

@media(max-width:360px) {
.blank { width:24px;height:30px;font-size:14px; }
.master-word-big { font-size:18px;letter-spacing:3px; }
}
</style>

</head>
<body>

<div class="blob b1"></div>
<div class="blob b2"></div>

<!-- TOPBAR -->

<div id="topbar">
<button class="tbtn" id="back-btn">â† Quitter</button>
<div class="topbar-logo">ğŸ”® MOT MYSTÃˆRE</div>
<div class="topbar-btns">
<button class="tbtn" id="theme-btn">â˜€ï¸ Clair</button>
</div>
</div>

<div id="toast"></div>

<!-- OVERLAY RÃ‰SULTAT MANCHE -->

<div id="result-overlay">
<div class="result-sheet">
<div class="sheet-handle"></div>
<div style="text-align:center;margin-bottom:14px;">
<div id="ro-icon" style="font-size:46px;margin-bottom:4px;">ğŸ‰</div>
<div id="ro-title" style="font-family:'Space Mono',monospace;font-size:18px;font-weight:700;letter-spacing:2px;"></div>
<div id="ro-word" style="font-size:12px;color:var(--txt2);margin-top:5px;font-weight:700;"></div>
</div>
<div id="ro-scores" style="margin-bottom:14px;"></div>
<button class="btn b-pk" id="ro-next" style="display:none;">MANCHE SUIVANTE â†’</button>
<div id="ro-wait" style="display:none;text-align:center;font-size:11px;color:var(--txt3);font-weight:700;letter-spacing:2px;padding:8px;">EN ATTENTE DE L'HÃ”TE...</div>
</div>
</div>

<div class="app">

<!-- â•â•â•â•â•â•â• HOME â•â•â•â•â•â•â• -->

<div id="s-home" class="sc on">
<div class="logo">
<span class="logo-em">ğŸ”®</span>
<div class="logo-name">Mot MystÃ¨re</div>
<div class="logo-sub">Indices Â· DÃ©duction Â· Multijoueur</div>
</div>
<div class="col mt8" style="max-width:300px;gap:10px;">
<button class="btn b-pk" id="btn-go-create">ğŸ¯ CrÃ©er une partie</button>
<button class="btn b-cy" id="btn-go-join">ğŸš€ Rejoindre</button>
</div>
<div class="xs muted tc mt8 bold">2 Ã  8 joueurs Â· RÃ´les qui tournent Â· 500+ mots</div>
</div>

<!-- â•â•â•â•â•â•â• CREATE â•â•â•â•â•â•â• -->

<div id="s-create" class="sc">
<div class="logo" style="padding:0;">
<span class="logo-em" style="font-size:40px;animation:none;">ğŸ¯</span>
<div class="logo-name" style="font-size:22px;">Nouvelle partie</div>
</div>
<div class="card card-pk w100">
<div class="col">
<div>
<span class="lbl">Ton pseudo</span>
<input class="inp" id="c-name" type="text" placeholder="Ex: Shadow42" maxlength="14" autocomplete="off">
</div>
<div>
<span class="lbl">Nombre de manches</span>
<select class="sel" id="c-rounds">
<option value="3">3 manches â€” rapide âš¡</option>
<option value="5" selected>5 manches â€” classique ğŸ¯</option>
<option value="8">8 manches â€” intense ğŸ”¥</option>
<option value="12">12 manches â€” lÃ©gendaire ğŸ†</option>
</select>
</div>
<div>
<span class="lbl">DifficultÃ©</span>
<div class="diff-row">
<div class="dtile on-e" data-diff="facile"><span class="di">ğŸ˜Š</span><span class="dn" style="color:var(--gr)">FACILE</span></div>
<div class="dtile" data-diff="moyen"> <span class="di">ğŸ”¥</span><span class="dn" style="color:var(--gd)">MOYEN</span></div>
<div class="dtile" data-diff="difficile"> <span class="di">ğŸ’€</span><span class="dn" style="color:var(--pk)">DIFFICILE</span></div>
</div>
</div>
<div>
<span class="lbl">CatÃ©gories</span>
<div class="chips" id="chips-wrap">
<div class="chip on" data-cat="tous">ğŸŒ TOUS</div>
<div class="chip" data-cat="animal">ğŸ¾ ANIMAUX</div>
<div class="chip" data-cat="pays">ğŸŒ PAYS</div>
<div class="chip" data-cat="sport">âš½ SPORT</div>
<div class="chip" data-cat="objet">ğŸ”§ OBJETS</div>
<div class="chip" data-cat="metier">ğŸ’¼ MÃ‰TIERS</div>
<div class="chip" data-cat="nature">ğŸŒ¿ NATURE</div>
<div class="chip" data-cat="food">ğŸ• FOOD</div>
<div class="chip" data-cat="science">ğŸ”¬ SCIENCE</div>
</div>
</div>
<div>
<span class="lbl">Temps par manche</span>
<select class="sel" id="c-timer">
<option value="60">60 secondes</option>
<option value="90" selected>90 secondes</option>
<option value="120">2 minutes</option>
</select>
</div>
<button class="btn b-pk" id="btn-create">CRÃ‰ER âœ¨</button>
<button class="btn b-gh b-sm" id="btn-create-back">â† Retour</button>
</div>
</div>
</div>

<!-- â•â•â•â•â•â•â• JOIN â•â•â•â•â•â•â• -->

<div id="s-join" class="sc">
<div class="logo" style="padding:0;">
<span class="logo-em" style="font-size:40px;animation:none;">ğŸš€</span>
<div class="logo-name" style="font-size:22px;">Rejoindre</div>
</div>
<div class="card card-cy w100">
<div class="col">
<div>
<span class="lbl">Ton pseudo</span>
<input class="inp" id="j-name" type="text" placeholder="Ex: Ninja99" maxlength="14" autocomplete="off">
</div>
<div>
<span class="lbl">Code de la partie</span>
<input class="inp-code" id="j-code" type="text" placeholder="XXXX" maxlength="4">
</div>
<button class="btn b-cy" id="btn-join">REJOINDRE â†’</button>
<button class="btn b-gh b-sm" id="btn-join-back">â† Retour</button>
</div>
</div>
</div>

<!-- â•â•â•â•â•â•â• LOBBY â•â•â•â•â•â•â• -->

<div id="s-lobby" class="sc">
<div class="tc w100">
<div class="lbl tc">CODE DE LA PARTIE</div>
<div class="codebox">
<span id="l-code" style="display:block;font-family:'Space Mono','Courier New',monospace;font-size:42px;font-weight:700;letter-spacing:12px;color:var(--gd);text-align:center;padding:4px 0;text-shadow:0 0 24px rgba(255,215,0,.4);">----</span>
<div class="copyhint" id="btn-copy">[ APPUYER POUR COPIER ]</div>
</div>
</div>
<div class="card w100">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
<span class="lbl" style="margin:0;">JOUEURS</span>
<span id="l-status" style="font-family:'Space Mono',monospace;font-size:10px;color:var(--txt3);font-weight:700;"></span>
</div>
<div class="plist" id="l-players"></div>
</div>
<div id="l-settings" class="xs muted tc" style="font-family:'Space Mono',monospace;line-height:2;font-weight:700;"></div>
<button class="btn b-gd w100" id="l-start" style="display:none;">âš¡ LANCER !</button>
<div id="l-hint" style="display:none;font-size:11px;color:var(--txt3);text-align:center;font-weight:700;letter-spacing:1px;"></div>
</div>

<!-- â•â•â•â•â•â•â• GAME â•â•â•â•â•â•â• -->

<div id="s-game" class="sc" style="max-width:480px;gap:10px;width:100%;">

<!-- En-tÃªte -->

<div class="game-hdr">
<div>
<div class="round-txt">MANCHE</div>
<div class="round-num" id="g-round">1/5</div>
</div>
<div style="display:flex;align-items:center;gap:10px;">
<div>
<div class="master-txt">MAÃTRE</div>
<div class="master-nm" id="g-master">â€”</div>
</div>
<div class="timer-ring">
<svg width="46" height="46" viewBox="0 0 46 46">
<circle cx="23" cy="23" r="20" fill="none" stroke="var(--s3)" stroke-width="3.5"/>
<circle id="timer-arc" cx="23" cy="23" r="20" fill="none" stroke="var(--cy)" stroke-width="3.5" stroke-linecap="round"/>
</svg>
<span id="timer-txt">90</span>
</div>
</div>
</div>

<!-- Progress bar -->

<div class="progbar w100"><div class="progfill" id="g-prog" style="width:0%"></div></div>

<!-- Badge de rÃ´le -->

<div id="role-badge" class="role-badge" style="display:none;"></div>

<!-- â”€â”€â”€ VUE MAÃTRE â”€â”€â”€ -->

<div id="ph-master" style="display:none;width:100%;">
<div class="master-zone">
<div class="master-lbl">ğŸ‘‘ TU ES LE MAÃTRE â€” DONNE DES INDICES !</div>
<div class="master-word-big" id="master-word">...</div>
<div class="xs muted tc" id="master-cat" style="margin-bottom:12px;font-weight:700;"></div>
<span class="lbl">Envoie un indice (sans le mot ni une partie du mot !)</span>
<div class="row w100" style="gap:8px;">
<input class="inp" id="hint-inp" type="text" placeholder="Ex: c'est un animal de la savane..." maxlength="80" style="flex:1;">
<button class="btn b-cy b-sm" id="btn-hint" style="width:auto;white-space:nowrap;">ENVOYER</button>
</div>
<div class="hints-list mt8" id="hints-sent"></div>
</div>
<div style="width:100%;margin-top:10px;">
<span class="lbl">TENTATIVES DES JOUEURS</span>
<div class="guess-feed" id="master-guesses">
<div class="no-hint">Personne n'a encore essayÃ©...</div>
</div>
</div>
</div>

<!-- â”€â”€â”€ VUE DEVINEUR â”€â”€â”€ -->

<div id="ph-guess" style="display:none;width:100%;">
<div class="word-zone">
<div class="wz-top">
<span class="pill p-pk" id="g-cat">CatÃ©gorie</span>
<span class="pill p-gd" id="g-pts">â­ 100pts</span>
</div>
<div class="blanks" id="g-blanks"></div>
<div class="word-info" id="g-info"></div>
</div>
<div style="width:100%;">
<span class="lbl">INDICES DU MAÃTRE</span>
<div class="hints-list" id="g-hints">
<div class="no-hint">En attente du premier indice...</div>
</div>
</div>
<div style="width:100%;">
<span class="lbl">TENTATIVES EN DIRECT</span>
<div class="guess-feed" id="g-guesses">
<div class="no-hint">Sois le premier Ã  essayer !</div>
</div>
</div>
<div id="guess-zone" style="width:100%;">
<div class="guess-row">
<input class="inp-guess" id="guess-inp" type="text" placeholder="TON MOT..." maxlength="32">
<button class="btn b-gd b-sm" id="btn-guess" style="width:auto;min-width:80px;border-radius:14px;">OK</button>
</div>
</div>
<div class="found-banner" id="found-banner">âœ… BRAVO ! Tu as trouvÃ© ! En attente des autres...</div>
</div>

</div><!-- /s-game -->

<!-- â•â•â•â•â•â•â• END â•â•â•â•â•â•â• -->

<div id="s-end" class="sc">
<div class="tc">
<div style="font-size:60px;">ğŸ†</div>
<div style="font-family:'Space Mono',monospace;font-size:22px;font-weight:700;letter-spacing:2px;margin-top:4px;background:linear-gradient(135deg,var(--gd),var(--pk));-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">PARTIE TERMINÃ‰E</div>
<div class="xs muted mt8 bold" id="e-winner"></div>
</div>
<div id="e-scores" class="w100"></div>
<div class="row w100 mt8" style="flex-wrap:wrap;justify-content:center;gap:8px;">
<button class="btn b-gd" id="btn-replay" style="width:auto;padding:14px 28px;">ğŸ”„ REJOUER</button>
<button class="btn b-gh" id="btn-home-end" style="width:auto;padding:14px 28px;">ğŸ  ACCUEIL</button>
</div>
</div>

</div><!-- /app -->

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
THÃˆME â€” s'applique AVANT tout le reste
data-theme sur <html> = fonctionne toujours
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var isLight = (localStorage.getItem('mm_theme') === 'light');
// Appliquer immÃ©diatement sur <html> (pas besoin du DOM)
document.documentElement.setAttribute('data-theme', isLight ? 'light' : 'dark');

function applyTheme(l) {
isLight = l;
document.documentElement.setAttribute('data-theme', l ? 'light' : 'dark');
localStorage.setItem('mm_theme', l ? 'light' : 'dark');
// Mettre Ã  jour le bouton si le DOM existe dÃ©jÃ 
var btn = document.getElementById('theme-btn');
if (btn) btn.textContent = l ? 'ğŸŒ™ Sombre' : 'â˜€ï¸ Clair';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FIREBASE â€” chargement silencieux
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var db = null, fbReady = false;
(function() {
var s1 = document.createElement('script');
s1.src = 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js';
s1.async = true;
s1.onload = function() {
var s2 = document.createElement('script');
s2.src = 'https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js';
s2.async = true;
s2.onload = function() {
try {
if (!firebase.apps.length) {
firebase.initializeApp({
apiKey: "AIzaSyAWW-rnF1dqdCc5kCuI-d9dTSMrBJCrSb0",
authDomain: "test-a5848.firebaseapp.com",
databaseURL: "https://test-a5848-default-rtdb.europe-west1.firebasedatabase.app",
projectId: "test-a5848",
storageBucket: "test-a5848.firebasestorage.app",
messagingSenderId: "704331097703",
appId: "1:704331097703:web:613a8f735e863a312316c2"
});
}
db = firebase.database();
fbReady = true;
} catch(e) { console.warn('Firebase:', e); }
};
document.head.appendChild(s2);
};
document.head.appendChild(s1);
})();
function whenFB(fn) { if (fbReady) fn(); else setTimeout(function(){ whenFB(fn); }, 80); }

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
BASE DE MOTS 500+
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var WORDS = {
animal:{
facile: ['CHAT','CHIEN','LAPIN','VACHE','MOUTON','COCHON','CHEVAL','POULE','CANARD','SINGE','OURS','LOUP','RENARD','SERPENT','GRENOUILLE','TIGRE','LION','ELEPHANT','GIRAFE','ZEBRE','DAUPHIN','PERROQUET','CROCODILE','FLAMANT'],
moyen: ['CAMELEON','HIPPOPOTAME','MANCHOT','TATOU','CAPYBARA','OKAPI','TAPIR','AXOLOTL','OUISTITI','PANGOLIN','NARVAL','DUGONG','PIRANHA','JAGUAR','GUEPARD','PANDA','KOALA','LEMUR','SURICATE','FENNEC'],
difficile: ['COELACANTHE','NAUTILE','TARDIGRADE','BINTURONG','FOSSA','QUOKKA','TARSIER','SAIGA','SHOEBILL','GHARIAL','OLM','MUDSKIPPER','ANGLERFISH']
},
pays:{
facile: ['FRANCE','ESPAGNE','ITALIE','PORTUGAL','BELGIQUE','SUISSE','ALLEMAGNE','JAPON','CHINE','CANADA','MEXIQUE','BRESIL','MAROC','ALGERIE','TUNISIE','EGYPTE','RUSSIE','INDE','AUSTRALIE','GRECE'],
moyen: ['MOZAMBIQUE','EQUATEUR','BOTSWANA','ALBANIE','SLOVENIE','MALAISIE','CAMBODGE','URUGUAY','PARAGUAY','NICARAGUA','GEORGIE','ARMENIE','AZERBAIDJAN','MONGOLIE','ETHIOPIE','OMAN','QATAR'],
difficile: ['LIECHTENSTEIN','TURKMENISTAN','TADJIKISTAN','MICRONESIA','VANUATU','KIRIBATI','NAURU','TUVALU','PALAU','DJIBOUTI','COMORES','SURINAME','BHOUTAN','ESWATINI']
},
sport:{
facile: ['FOOTBALL','TENNIS','NATATION','BOXE','RUGBY','GOLF','BASKET','VOLLEY','JUDO','KARATE','VELO','COURSE','HANDBALL','PATINAGE','SKI','SURF','BASEBALL','HOCKEY'],
moyen: ['BADMINTON','ESCRIME','AVIRON','TRIATLON','PENTATHLON','BOBSLEIGH','CURLING','WATERPOLO','SUMO','KENDO','LACROSSE','POLO','SQUASH','BOWLING','CRICKET'],
difficile: ['SEPAKTAKRAW','KABADDI','BOSSABALL','BUZKASHI','PESAPALLO','PANKRATION','HORNUSSEN','SLAMBALL','KRONUM','BEIBOL']
},
objet:{
facile: ['TABLE','CHAISE','LAMPE','STYLO','LIVRE','FENETRE','MIROIR','TELEPHONE','ORDINATEUR','CISEAUX','PARAPLUIE','HORLOGE','BOUGIE','COUSSIN','TABLEAU','LUNETTES','CASQUE'],
moyen: ['THERMOMETRE','MICROSCOPE','TELESCOPE','BOUSSOLE','GYROSCOPE','KALEIDOSCOPE','SEXTANT','ASTROLABE','METRONOME','STETHOSCOPE','ALAMBIC','SOUFFLET','PERISCOPE'],
difficile: ['OCTANT','HYGROMETRE','PYRANOMETRE','BOLOMETRE','SPECTROSCOPE','REFRACTOMETRE','CRYOSTAT','MICROTOME','GALVANOMETRE','DIAPASON']
},
metier:{
facile: ['DOCTEUR','POMPIER','PILOTE','CUISINIER','PROFESSEUR','ARCHITECTE','AVOCAT','PLOMBIER','COIFFEUR','ACTEUR','CHANTEUR','PHOTOGRAPHE','JARDINIER','BOUCHER','BOULANGER','INFIRMIER'],
moyen: ['OSTEOPATHE','SOMMELIER','LUTHIER','TAXIDERMISTE','CARTOGRAPHE','ORFEVRE','CALLIGRAPHE','BOTTIER','CHAPELIER','TONNELIER','CHIROPRACTEUR','HERBORISTE'],
difficile: ['THANATOLOGUE','CETOLOGUE','POMOLOGUE','HERPETOLOGUE','MALACOLOGISTE','PALEOBOTANISTE','ARACHNOLOGUE','GLACIOLOGUE','CHRONOBIOLOGISTE']
},
nature:{
facile: ['MONTAGNE','RIVIERE','FORET','DESERT','OCEAN','VOLCAN','VALLEE','PLAGE','GROTTE','PRAIRIE','COLLINE','GLACIER','ETANG','MARAIS','FJORD','CASCADE'],
moyen: ['STALAGMITE','ESTUAIRE','MANGROVE','ATOLL','SAVANE','TOUNDRA','TAIGA','STEPPE','MORAINE','SOLFATARE','GEYSER','LAGUNE','TOURBIERE','CALDEIRA'],
difficile: ['KARST','LOESS','DRUMLINS','YARDANG','PENEPLAINE','HORST','GRABEN','OPHIOLITE','BATHOLITE','GRANULITE','ECLOGITE']
},
food:{
facile: ['PIZZA','SUSHI','BURGER','CREPE','SALADE','SOUPE','PASTA','FROMAGE','CHOCOLAT','GLACE','GATEAU','POISSON','POULET','STEAK','TARTE','QUICHE','OMELETTE'],
moyen: ['BOUILLABAISSE','COUSCOUS','PAELLA','RACLETTE','BRUSCHETTA','TIRAMISU','GUACAMOLE','TABOULEH','RATATOUILLE','CASSOULET','CEVICHE','GOULASH','TAGINE','KIMCHI'],
difficile: ['BRIGADEIRO','JALEBI','BAKLAVA','INJERA','LUTEFISK','HAGGIS','SURSTROMING','NATTO','CEVAPI','KHINKALI','DOLMADES']
},
science:{
facile: ['ATOME','ELECTRON','PROTON','MOLECULE','CELLULE','ADN','GENE','PROTEINE','ENZYME','VIRUS','BACTERIE','PLASMA','NEUTRON','ISOTOPE','LASER','MAGNET'],
moyen: ['PHOTOSYNTHESE','MITOCHONDRIE','CHROMOSOME','RIBOSOMES','CHLOROPHYLLE','CATALYSE','OSMOSE','DIFFRACTION','RESONANCE','THERMOLYSE','ELECTROLYSE','QUASAR'],
difficile: ['BIOLUMINESCENCE','PIEZOELECTRICITE','SUPERCONDUCTEUR','BREMSSTRAHLUNG','RENORMALISATION','DECOHERENCE','HOLOMORPHIE','SPINTRONIC']
},
tous:{
facile: ['SOLEIL','LUNE','ETOILE','MAISON','VOITURE','FLEUR','ARBRE','ENFANT','AMOUR','JOIE','REVE','NUIT','JARDIN','BATEAU','AVION','MUSIQUE'],
moyen: ['AVENTURE','MYSTERE','LIBERTE','SAGESSE','COURAGE','JUSTICE','BONHEUR','LUMIERE','SILENCE','HARMONIE','PATIENCE','ENERGIE','BEAUTE'],
difficile: ['SERENDIPITE','INEFFABLE','EPHEMERE','PALIMPSESTE','SYNCRETISME','ESCHATOLOGIE','LOGOMACIE','QUIDDITE']
}
};

function getWord(cats, diff) {
var pool = [];
(cats||['tous']).forEach(function(cat) {
var c = WORDS[cat];
if (c && c[diff]) pool = pool.concat(c[diff]);
});
if (!pool.length) pool = WORDS.tous[diff] || WORDS.tous.facile;
return pool[Math.floor(Math.random() * pool.length)];
}
function findCat(word) {
for (var c in WORDS) for (var d in WORDS[c]) if (WORDS[c][d].indexOf(word) !== -1) return c;
return 'tous';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
STATE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
var COLORS = ['#fe2c55','#25f4ee','#ffd700','#a855f7','#1db954','#ff8c00','#3d7fff','#ff6b6b'];
var AVATARS = ['ğŸ¯','ğŸ¦Š','ğŸ’€','ğŸ¤–','ğŸ‘¾','ğŸŒŸ','ğŸ”¥','âš¡'];

var myId = sessionStorage.getItem('mm3_uid') || Math.random().toString(36).slice(2,11);
sessionStorage.setItem('mm3_uid', myId);
var myName = '', myColor = '', myAvatar = '';
var roomCode = '', roomRef = null, gbListener = null;
var selDiff = 'facile', selCats = ['tous'];
var timerInterval = null, timerMax = 90, timerLeft = 0;
var overlayShown = false;

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
NAV
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function go(id) {
document.querySelectorAll('.sc').forEach(function(s) { s.classList.remove('on'); });
document.getElementById(id).classList.add('on');
var showBack = ['s-create','s-join','s-lobby','s-game','s-end'].includes(id);
document.getElementById('back-btn').classList.toggle('vis', showBack);
}
function goBack() { leaveRoom(); go('s-home'); }
function goHome() { leaveRoom(); go('s-home'); }
function leaveRoom() {
stopTimer();
if (gbListener) { gbListener(); gbListener = null; }
roomRef = null; roomCode = '';
overlayShown = false;
var ov = document.getElementById('result-overlay');
if (ov) ov.classList.remove('show');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
UTILS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function genCode() {
var c = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
return Array.from({length:4}, function(){ return c[Math.floor(Math.random()*c.length)]; }).join('');
}
var toastT;
function toast(msg, type, dur) {
dur = dur||2600;
var t = document.getElementById('toast');
t.textContent = msg; t.className = 'up '+(type||'if');
clearTimeout(toastT); toastT = setTimeout(function(){ t.classList.remove('up'); }, dur);
}
function shk(id) { var e=document.getElementById(id); if(!e)return; e.classList.add('shk'); setTimeout(function(){e.classList.remove('shk');},400); }
function copyCode() {
if (navigator.clipboard) navigator.clipboard.writeText(roomCode)
.then(function(){ toast('CODE COPIÃ‰ !','ok'); })
.catch(function(){ toast('CODE: '+roomCode,'if'); });
else toast('CODE: '+roomCode,'if');
}
function confetti() {
['#fe2c55','#25f4ee','#ffd700','#a855f7','#1db954'].forEach(function(col) {
for (var i=0;i<14;i++) {
var el=document.createElement('div'); var sz=5+Math.random()*8;
el.style.cssText='position:fixed;left:'+Math.random()*100+'vw;top:-20px;width:'+sz+'px;height:'+sz+'px;background:'+col+';border-radius:'+(Math.random()>.5?'50%':'2px')+';animation:confY '+(2+Math.random()*3)+'s '+(Math.random()*1.5)+'s linear forwards;z-index:9999;pointer-events:none;';
document.body.appendChild(el); setTimeout(function(){ el.remove(); },5500);
}
});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
TIMER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function startTimer(sec, onEnd) {
clearInterval(timerInterval);
timerLeft = sec; timerMax = sec;
updateTimerUI(timerLeft);
timerInterval = setInterval(function() {
timerLeft--;
updateTimerUI(timerLeft);
if (timerLeft <= 0) { clearInterval(timerInterval); if (onEnd) onEnd(); }
}, 1000);
}
function stopTimer() { clearInterval(timerInterval); }
function updateTimerUI(t) {
var txt = document.getElementById('timer-txt');
var arc = document.getElementById('timer-arc');
if (!txt||!arc) return;
txt.textContent = t;
arc.style.strokeDashoffset = 126 * (1 - t/timerMax);
var col = t>timerMax*.5?'var(--cy)':t>timerMax*.25?'var(--gd)':'var(--pk)';
arc.style.stroke = col; txt.style.color = col;
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
CRÃ‰ER PARTIE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function createGame() {
var name = document.getElementById('c-name').value.trim();
if (!name) { toast('ENTRE TON PSEUDO !','er'); shk('c-name'); return; }
if (!selCats.length) { toast('CHOISIS UNE CATÃ‰GORIE !','er'); return; }
var rounds = parseInt(document.getElementById('c-rounds').value);
var timer = parseInt(document.getElementById('c-timer').value);
var code = genCode();
myName=name; myColor=COLORS[0]; myAvatar=AVATARS[0]; roomCode=code;

var data = {
code:code, hostId:myId, status:'lobby',
rounds:rounds, timer:timer, difficulty:selDiff, categories:selCats,
currentRound:0, masterIdx:0,
currentWord:null, currentCat:null,
hints:[], guesses:{}, scores:{}, roundWinners:{},
players:{}, createdAt:Date.now(), updatedAt:Date.now()
};
data.players[myId] = {id:myId,name:name,color:myColor,avatar:myAvatar,joinedAt:Date.now()};
data.scores[myId] = 0;

whenFB(function() {
db.ref('mm_games/'+code).set(data)
.then(function() { attachListener(code); go('s-lobby'); toast('CRÃ‰Ã‰ ! CODE: '+code,'ok',4000); })
.catch(function(e){ toast('ERREUR: '+e.message,'er'); });
});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
REJOINDRE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function joinGame() {
var name = document.getElementById('j-name').value.trim();
var code = document.getElementById('j-code').value.trim().toUpperCase();
if (!name) { toast('ENTRE TON PSEUDO !','er'); shk('j-name'); return; }
if (code.length!==4) { toast('CODE Ã€ 4 CARACTÃˆRES !','er'); shk('j-code'); return; }

whenFB(function() {
db.ref('mm_games/'+code).get().then(function(snap) {
if (!snap.exists()) { toast('CODE INVALIDE !','er'); shk('j-code'); return; }
var game = snap.val();
if (game.status!=='lobby') { toast('PARTIE DÃ‰JÃ€ EN COURS !','er'); return; }
var cnt = Object.keys(game.players||{}).length;
if (cnt>=8) { toast('PARTIE PLEINE !','er'); return; }
var idx = cnt % COLORS.length;
myName=name; myColor=COLORS[idx]; myAvatar=AVATARS[idx]; roomCode=code;

var upd = {};
upd['players/'+myId] = {id:myId,name:name,color:myColor,avatar:myAvatar,joinedAt:Date.now()};
upd['scores/'+myId] = 0;
upd['updatedAt'] = Date.now();

db.ref('mm_games/'+code).update(upd)
.then(function() { attachListener(code); go('s-lobby'); toast('BIENVENUE '+name.toUpperCase()+'!','ok'); })
.catch(function(e){ toast('ERREUR: '+e.message,'er'); });
}).catch(function(e){ toast('ERREUR: '+e.message,'er'); });
});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LISTENER FIREBASE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function attachListener(code) {
if (gbListener) gbListener();
roomRef = db.ref('mm_games/'+code);
roomRef.on('value', function(snap) {
if (!snap.exists()) return;
var game = snap.val();
var cur = (document.querySelector('.sc.on')||{}).id || '';
if (game.status==='lobby') { renderLobby(game); }
else if (game.status==='playing') { if(cur==='s-lobby') go('s-game'); renderGame(game); }
else if (game.status==='round_end') { if(cur==='s-lobby') go('s-game'); renderGame(game); showRoundEnd(game); }
else if (game.status==='end') { renderEndGame(game); }
});
gbListener = function() { roomRef.off('value'); };
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LOBBY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderLobby(game) {
document.getElementById('l-code').textContent = game.code;
var players = Object.values(game.players||{}).sort(function(a,b){return a.joinedAt-b.joinedAt;});
var listEl = document.getElementById('l-players'); listEl.innerHTML='';
players.forEach(function(p) {
var isMe=p.id===myId, isHost=p.id===game.hostId;
var div=document.createElement('div');
div.className='prow'+(isMe?' me':'')+(isHost?' host':'');
div.innerHTML=
'<div class="pav" style="background:'+p.color+'22;color:'+p.color+'">'+p.avatar+'</div>'+
'<div class="pnm">'+p.name+'</div>'+
(isHost?'<span class="pill p-cy">HÃ”TE</span>':'')+
(isMe?'<span class="pill p-pk">MOI</span>':'')+
'<div class="pscore">'+((game.scores&&game.scores[p.id])||0)+'pts</div>';
listEl.appendChild(div);
});
var cnt=players.length;
document.getElementById('l-status').textContent=cnt+'/8';
var catN={tous:'TOUS',animal:'ANIMAUX',pays:'PAYS',sport:'SPORT',objet:'OBJETS',metier:'MÃ‰TIERS',nature:'NATURE',food:'FOOD',science:'SCIENCE'};
document.getElementById('l-settings').innerHTML=
'<strong style="color:var(--txt)">'+game.rounds+' MANCHES</strong> Â· '+
'<span style="color:var(--gd)">'+game.difficulty.toUpperCase()+'</span> Â· '+
(game.categories||['tous']).map(function(c){return catN[c]||c.toUpperCase();}).join(' Â· ')+
' Â· '+game.timer+'s';
var isHost=game.hostId===myId, canStart=cnt>=2;
document.getElementById('l-start').style.display=(isHost&&canStart)?'flex':'none';
var hint=document.getElementById('l-hint');
if (!canStart) { hint.style.display='block'; hint.textContent='Il faut au moins 2 joueurs !'; }
else if (!isHost) { hint.style.display='block'; hint.textContent="L'hÃ´te va lancer..."; }
else { hint.style.display='none'; }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LANCER + ROTATION DES RÃ”LES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function startGame() {
whenFB(function() {
db.ref('mm_games/'+roomCode).get().then(function(snap) {
var game=snap.val(); if(!game)return;
var pids=Object.keys(game.players).sort(function(a,b){return game.players[a].joinedAt-game.players[b].joinedAt;});
if(pids.length<2){ toast('IL FAUT 2 JOUEURS !','er'); return; }
// Manche 1, MaÃ®tre = joueur 0
launchRound(game, pids, 0, 1);
});
});
}

/*
ROTATION :
- Manche 1 â†’ masterIdx=0 â†’ pids[0] est MaÃ®tre, tous les autres devinent
- Manche 2 â†’ masterIdx=1 â†’ pids[1] est MaÃ®tre, tous les autres devinent
- Manche N â†’ masterIdx=(N-1) % nombre_joueurs
- Nouveau mot Ã  chaque manche (getWord = alÃ©atoire parmi les catÃ©gories)
*/
function launchRound(game, pids, masterIdx, roundNum) {
var masterId = pids[masterIdx % pids.length];
// Nouveau mot alÃ©atoire â€” diffÃ©rent Ã  chaque appel grÃ¢ce Ã  Math.random()
var word = getWord(game.categories, game.difficulty);
var cat = findCat(word);

// Tous les NON-maÃ®tres ont une entrÃ©e dans guesses (null = pas encore jouÃ©)
var initGuesses = {};
pids.forEach(function(pid) { if (pid!==masterId) initGuesses[pid]=null; });

overlayShown = false;
db.ref('mm_games/'+roomCode).update({
status: 'playing',
currentRound: roundNum,
masterIdx: masterIdx,
masterId: masterId,
currentWord: word,
currentCat: cat,
hints: [],
guesses: initGuesses,
roundWinners: {},
roundStart: Date.now(),
updatedAt: Date.now()
});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
RENDU JEU
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderGame(game) {
if (game.status!=='playing' && game.status!=='round_end') return;
stopTimer();

var isMaster = game.masterId===myId;
var isHost = game.hostId===myId;

// Header
document.getElementById('g-round').textContent = game.currentRound+'/'+game.rounds;
document.getElementById('g-master').textContent = (game.players&&game.players[game.masterId]?game.players[game.masterId].name:'?').toUpperCase();
document.getElementById('g-prog').style.width = ((game.currentRound-1)/game.rounds*100)+'%';

// Badge de rÃ´le (affichÃ© une fois par manche)
var badge = document.getElementById('role-badge');
badge.style.display = 'flex';
if (isMaster) {
badge.className = 'role-badge role-master';
badge.innerHTML = 'ğŸ‘‘ TU ES LE MAÃTRE cette manche !';
} else {
badge.className = 'role-badge role-guesser';
badge.innerHTML = 'ğŸ” TU DEVINES cette manche !';
}

// Afficher la bonne vue
document.getElementById('ph-master').style.display = isMaster ? 'block' : 'none';
document.getElementById('ph-guess').style.display = isMaster ? 'none' : 'block';

if (game.status==='playing') {
var elapsed = Math.floor((Date.now()-game.roundStart)/1000);
var remaining = Math.max(0, game.timer-elapsed);
if (remaining>0) {
startTimer(remaining, function() {
if (isHost) endRound(game, false);
});
}
if (isMaster) renderMasterView(game);
else renderGuessView(game);
} else {
// round_end â€” rafraÃ®chir tentatives seulement
renderGuessesOnly(isMaster?'master-guesses':'g-guesses', game);
}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VUE MAÃTRE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderMasterView(game) {
document.getElementById('master-word').textContent = game.currentWord||'...';
document.getElementById('master-cat').textContent = 'CatÃ©gorie : '+(game.currentCat||'?').toUpperCase();
var sentEl = document.getElementById('hints-sent'); sentEl.innerHTML='';
(game.hints||[]).forEach(function(h,i) {
var d=document.createElement('div'); d.className='hint-item';
d.innerHTML='<span class="hint-num">#'+(i+1)+'</span><div class="hint-txt">'+h.text+'</div>';
sentEl.appendChild(d);
});
renderGuessesOnly('master-guesses', game);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
VUE DEVINEUR
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderGuessView(game) {
var word = game.currentWord||'';
var hints = game.hints||[];

// Blancs avec rÃ©vÃ©lation progressive (+1 lettre tous les 2 indices)
var blanksEl = document.getElementById('g-blanks'); blanksEl.innerHTML='';
var revealed = new Set();
if (hints.length>=2) {
var n=Math.floor(hints.length/2);
for(var i=0;i<Math.min(n,word.length-1);i++) revealed.add(i);
}
for(var i=0;i<word.length;i++) {
var sp=document.createElement('span');
if (word[i]===' ') { sp.className='blank space'; }
else {
sp.className='blank'+(revealed.has(i)?' lit':'');
sp.textContent=revealed.has(i)?word[i]:'';
}
blanksEl.appendChild(sp);
}
var realLen=word.replace(/ /g,'').length;
document.getElementById('g-info').textContent=realLen+' LETTRE'+(realLen>1?'S':'')+(word.includes(' ')?' Â· PLUSIEURS MOTS':'');
document.getElementById('g-pts').textContent='â­ '+Math.max(10,100-(hints.length*10))+'pts';
document.getElementById('g-cat').textContent=(game.currentCat||'?').toUpperCase();

// Indices
var hEl=document.getElementById('g-hints'); hEl.innerHTML='';
if (!hints.length) {
hEl.innerHTML='<div class="no-hint">En attente du premier indice...</div>';
} else {
hints.forEach(function(h,i){
var d=document.createElement('div'); d.className='hint-item';
d.innerHTML='<span class="hint-num">#'+(i+1)+'</span><div><div class="hint-txt">'+h.text+'</div><div class="hint-by">Par '+h.who+'</div></div>';
hEl.appendChild(d);
});
}

// Tentatives
renderGuessesOnly('g-guesses', game);

// Input visible seulement si pas encore trouvÃ©
var myGuess = game.guesses&&game.guesses[myId];
var found = myGuess&&(myGuess===true||myGuess.correct);
document.getElementById('guess-zone').style.display = found?'none':'block';
document.getElementById('found-banner').classList.toggle('on', found);
}

function renderGuessesOnly(feedId, game) {
var feed=document.getElementById(feedId); if(!feed)return;
feed.innerHTML='';
var guesses=game.guesses||{}, any=false;
Object.entries(guesses).forEach(function(e){
var pid=e[0], val=e[1];
if (!val||val===true||typeof val!=='object') return;
any=true;
var p=game.players&&game.players[pid];
var d=document.createElement('div');
d.className='guess-item'+(val.correct?' correct':val.close?' close':'');
d.innerHTML=
'<span class="gn" style="color:'+(p?p.color:'#fff')+'">'+(p?p.name:'?')+'</span>'+
'<span class="gw">'+val.word+'</span>'+
'<span class="gr-icon">'+(val.correct?'âœ…':val.close?'ğŸŸ¡':'âŒ')+'</span>';
feed.appendChild(d);
});
if (!any) {
feed.innerHTML='<div class="no-hint">'+(feedId==='master-guesses'?'Personne n\'a encore essayÃ©...':'Sois le premier !')+'</div>';
}
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ENVOYER INDICE (MAÃTRE)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function sendHint() {
var inp=document.getElementById('hint-inp');
var txt=inp.value.trim();
if (!txt){ toast('Ã‰CRIS UN INDICE !','er'); shk('hint-inp'); return; }
whenFB(function(){
db.ref('mm_games/'+roomCode).get().then(function(snap){
var game=snap.val(); if(!game)return;
var word=(game.currentWord||'').toLowerCase();
// VÃ©rifier que l'indice ne contient pas le mot
if (txt.toLowerCase().includes(word)){ toast('PAS LE DROIT DE DIRE LE MOT !','er'); shk('hint-inp'); return; }
var hints=game.hints||[];
hints.push({text:txt, who:myName, at:Date.now()});
db.ref('mm_games/'+roomCode).update({hints:hints, updatedAt:Date.now()});
inp.value='';
toast('INDICE ENVOYÃ‰ !','ok');
});
});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
DEVINER
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function lev(a,b) {
var m=a.length,n=b.length,dp=[];
for(var i=0;i<=m;i++){dp[i]=[i];for(var j=1;j<=n;j++)dp[i][j]=i?0:j;}
for(var i=1;i<=m;i++) for(var j=1;j<=n;j++)
dp[i][j]=a[i-1]===b[j-1]?dp[i-1][j-1]:1+Math.min(dp[i-1][j],dp[i][j-1],dp[i-1][j-1]);
return dp[m][n];
}

function submitGuess() {
var inp=document.getElementById('guess-inp');
var guess=inp.value.trim().toUpperCase();
if (!guess){ toast('ENTRE UN MOT !','er'); shk('guess-inp'); return; }
inp.value='';
whenFB(function(){
db.ref('mm_games/'+roomCode).get().then(function(snap){
var game=snap.val();
if (!game||game.status!=='playing') return;
// DÃ©jÃ  trouvÃ© ?
var ex=game.guesses&&game.guesses[myId];
if (ex&&ex.correct){ toast('TU AS DÃ‰JÃ€ TROUVÃ‰ !','if'); return; }

var target = (game.currentWord||'').toUpperCase();
var correct = guess===target;
var close = !correct && lev(guess,target)<=2;
var pts = Math.max(10, 100-((game.hints||[]).length*10));

var upd={};
upd['guesses/'+myId]={word:guess,correct:correct,close:close,at:Date.now()};
upd['updatedAt']=Date.now();
if (correct) {
upd['scores/'+myId]=((game.scores&&game.scores[myId])||0)+pts;
if(!(game.roundWinners&&game.roundWinners[myId]))
upd['roundWinners/'+myId]={name:myName,pts:pts};
toast('ğŸ‰ BRAVO ! +'+pts+' pts !','gd',3000);
} else if (close) {
toast('ğŸŸ¡ TOUT PRÃˆS !','if');
} else {
toast('âŒ RATÃ‰','er',1500);
}

db.ref('mm_games/'+roomCode).update(upd).then(function(){
if (!correct) return;
// Tous les devineurs ont trouvÃ© ?
db.ref('mm_games/'+roomCode).get().then(function(snap2){
var g2=snap2.val(); if(!g2)return;
var guessers=Object.keys(g2.players).filter(function(pid){return pid!==g2.masterId;});
var allFound=guessers.every(function(pid){
var g=g2.guesses&&g2.guesses[pid]; return g&&g.correct;
});
if (allFound&&g2.hostId===myId) endRound(g2,true);
});
});
});
});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FIN DE MANCHE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function endRound(game, allFound) {
stopTimer();
var upd={status:'round_end', updatedAt:Date.now()};
// Bonus maÃ®tre : +20pts par devineur qui a trouvÃ©
var winners=game.roundWinners||{};
if (Object.keys(winners).length>0) {
var bonus=Object.keys(winners).length*20;
upd['scores/'+game.masterId]=((game.scores&&game.scores[game.masterId])||0)+bonus;
}
db.ref('mm_games/'+roomCode).update(upd);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
OVERLAY RÃ‰SULTAT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function showRoundEnd(game) {
if (overlayShown) return;
overlayShown=true;
var ov=document.getElementById('result-overlay');
ov.classList.add('show');
var winners=game.roundWinners||{};
var hasWin=Object.keys(winners).length>0;
document.getElementById('ro-icon').textContent = hasWin?'ğŸ‰':'â°';
document.getElementById('ro-title').textContent = hasWin?'MOT TROUVÃ‰ !':'TEMPS Ã‰COULÃ‰ !';
document.getElementById('ro-word').textContent = 'Le mot Ã©tait : '+game.currentWord;
var scEl=document.getElementById('ro-scores'); scEl.innerHTML='';
Object.values(winners).forEach(function(w){
var d=document.createElement('div');
d.style.cssText='font-family:"Space Mono",monospace;font-size:13px;color:var(--gr);margin:3px 0;font-weight:700;';
d.textContent='ğŸ… '+w.name+' +'+w.pts+'pts';
scEl.appendChild(d);
});
if(!hasWin){
var d=document.createElement('div');
d.style.cssText='font-size:12px;color:var(--txt2);font-weight:700;';
d.textContent='Personne n\'a trouvÃ© ce round...';
scEl.appendChild(d);
}
// Qui sera le prochain maÃ®tre ?
var pids=Object.keys(game.players).sort(function(a,b){return game.players[a].joinedAt-game.players[b].joinedAt;});
var nextMasterIdx=(game.masterIdx+1)%pids.length;
var nextMasterId=pids[nextMasterIdx];
var nextMasterName=game.players[nextMasterId]?game.players[nextMasterId].name:'?';
if(game.currentRound<game.rounds){
var d2=document.createElement('div');
d2.style.cssText='font-family:"Space Mono",monospace;font-size:10px;color:var(--cy);margin-top:8px;letter-spacing:1px;';
d2.textContent='ğŸ‘‘ Prochain maÃ®tre : '+nextMasterName.toUpperCase();
scEl.appendChild(d2);
}
var isHost=game.hostId===myId, isLast=game.currentRound>=game.rounds;
document.getElementById('ro-next').style.display=isHost?'flex':'none';
document.getElementById('ro-wait').style.display=isHost?'none':'block';
document.getElementById('ro-next').textContent=isLast?'ğŸ† RÃ‰SULTATS':'MANCHE SUIVANTE â†’';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
MANCHE SUIVANTE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function nextRound() {
overlayShown=false;
document.getElementById('result-overlay').classList.remove('show');
whenFB(function(){
db.ref('mm_games/'+roomCode).get().then(function(snap){
var game=snap.val(); if(!game||game.hostId!==myId)return;
if(game.currentRound>=game.rounds){
db.ref('mm_games/'+roomCode).update({status:'end',updatedAt:Date.now()});
return;
}
var pids=Object.keys(game.players).sort(function(a,b){return game.players[a].joinedAt-game.players[b].joinedAt;});
// Rotation : masterIdx avance de 1
var nextIdx=(game.masterIdx+1)%pids.length;
launchRound(game, pids, nextIdx, game.currentRound+1);
});
});
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FIN DE PARTIE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
function renderEndGame(game) {
stopTimer(); overlayShown=false;
document.getElementById('result-overlay').classList.remove('show');
go('s-end'); confetti();
var players=Object.values(game.players||{}).sort(function(a,b){return((game.scores&&game.scores[b.id])||0)-((game.scores&&game.scores[a.id])||0);});
var medals=['ğŸ¥‡','ğŸ¥ˆ','ğŸ¥‰'];
var tbl=document.getElementById('e-scores'); tbl.innerHTML='';
players.forEach(function(p,i){
var div=document.createElement('div'); div.className='score-row';
div.innerHTML=
'<div class="s-rank">'+(medals[i]||'#'+(i+1))+'</div>'+
'<div class="pav" style="background:'+p.color+'22;color:'+p.color+'">'+p.avatar+'</div>'+
'<div class="s-name">'+p.name+(p.id===myId?' <span style="font-size:10px;color:var(--txt3)">(moi)</span>':'')+'</div>'+
'<div class="s-pts">'+((game.scores&&game.scores[p.id])||0)+'pts</div>';
tbl.appendChild(div);
});
document.getElementById('e-winner').textContent=players[0]?(players[0].id===myId?'ğŸ‰ TU AS GAGNÃ‰ !':players[0].name.toUpperCase()+' REMPORTE LA PARTIE !'):'';
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
EVENT LISTENERS â€” tout ici, rien dans le HTML
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
document.addEventListener('DOMContentLoaded', function() {

// ThÃ¨me â€” mettre Ã  jour le bouton maintenant que le DOM existe
document.getElementById('theme-btn').textContent = isLight ? 'ğŸŒ™ Sombre' : 'â˜€ï¸ Clair';
document.getElementById('theme-btn').addEventListener('click', function() { applyTheme(!isLight); });

// Nav
document.getElementById('back-btn').addEventListener('click', goBack);
document.getElementById('btn-go-create').addEventListener('click', function(){ go('s-create'); });
document.getElementById('btn-go-join').addEventListener('click', function(){ go('s-join'); });

// DifficultÃ©
document.querySelectorAll('.dtile').forEach(function(tile) {
tile.addEventListener('click', function() {
document.querySelectorAll('.dtile').forEach(function(t){ t.className=t.className.replace(/on-[emh]/g,'').trim(); });
var d=this.dataset.diff;
this.classList.add(d==='facile'?'on-e':d==='moyen'?'on-m':'on-h');
selDiff=d;
});
});

// CatÃ©gories
document.getElementById('chips-wrap').addEventListener('click', function(e) {
var chip=e.target;
while(chip&&chip!==this&&!chip.classList.contains('chip')) chip=chip.parentElement;
if(!chip||!chip.classList.contains('chip')) return;
var cat=chip.dataset.cat;
if (cat==='tous') {
document.querySelectorAll('.chip').forEach(function(c){c.classList.remove('on');});
chip.classList.add('on'); selCats=['tous'];
} else {
document.querySelector('.chip[data-cat="tous"]').classList.remove('on');
chip.classList.toggle('on');
selCats=Array.from(document.querySelectorAll('.chip.on')).map(function(c){return c.dataset.cat;});
if(!selCats.length){ document.querySelector('.chip[data-cat="tous"]').classList.add('on'); selCats=['tous']; }
}
});

// Create
document.getElementById('btn-create').addEventListener('click', createGame);
document.getElementById('btn-create-back').addEventListener('click', function(){ go('s-home'); });

// Join
document.getElementById('btn-join').addEventListener('click', joinGame);
document.getElementById('btn-join-back').addEventListener('click', function(){ go('s-home'); });
var jc=document.getElementById('j-code');
jc.addEventListener('input', function(){ this.value=this.value.toUpperCase().replace(/[^A-Z0-9]/g,''); });
jc.addEventListener('keydown', function(e){ if(e.key==='Enter') joinGame(); });

// Lobby
document.getElementById('l-start').addEventListener('click', startGame);
document.getElementById('btn-copy').addEventListener('click', copyCode);

// MaÃ®tre
document.getElementById('btn-hint').addEventListener('click', sendHint);
document.getElementById('hint-inp').addEventListener('keydown', function(e){ if(e.key==='Enter') sendHint(); });

// Devineurs
var gi=document.getElementById('guess-inp');
gi.addEventListener('input', function(){ this.value=this.value.toUpperCase(); });
gi.addEventListener('keydown', function(e){ if(e.key==='Enter') submitGuess(); });
document.getElementById('btn-guess').addEventListener('click', submitGuess);

// Overlay
document.getElementById('ro-next').addEventListener('click', nextRound);

// End
document.getElementById('btn-replay').addEventListener('click', goHome);
document.getElementById('btn-home-end').addEventListener('click', goHome);

}); // DOMContentLoaded
</script>

</body>
</html>