<!DOCTYPE html>

<html lang="fr" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>LEXIS - Devine le Mot</title>
<link href="https://fonts.googleapis.com/css2?family=Syne:wght@400;600;700;800;900&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
<style>
@charset "UTF-8";
/* ==================================================
LEXIS - Design System
Instagram x Startup 2026
Palette : rose #E1306C * orange #F77737 * violet #833AB4
================================================== */
:root {
--p1: #833AB4; --p2: #E1306C; --p3: #F77737;
--grad: linear-gradient(135deg, #833AB4 0%, #E1306C 50%, #F77737 100%);
--grad-r: linear-gradient(135deg, #F77737 0%, #E1306C 50%, #833AB4 100%);
--grad-soft: linear-gradient(135deg, rgba(131,58,180,.12) 0%, rgba(225,48,108,.08) 50%, rgba(247,119,55,.06) 100%);

â€“bg: #FAFAFA;
â€“surf: #FFFFFF;
â€“surf2: #F5F5F5;
â€“surf3: #EDEDED;
â€“bord: rgba(0,0,0,0.07);
â€“txt: #0A0A0A;
â€“txt2: #6B6B6B;
â€“txt3: #BDBDBD;
â€“shadow: 0 4px 24px rgba(0,0,0,0.06);
â€“shadow2: 0 12px 48px rgba(0,0,0,0.10);
â€“shadow3: 0 24px 80px rgba(0,0,0,0.15);
â€“glass: rgba(255,255,255,0.78);
â€“glass-b: blur(24px) saturate(180%);
â€“r: 22px; â€“r2: 16px; â€“r3: 12px;
}
[data-theme=â€œdarkâ€] {
â€“bg: #0C0C0E; â€“surf: #181820;
â€“surf2: #22222D; â€“surf3: #2C2C3A;
â€“bord: rgba(255,255,255,0.06);
â€“txt: #F2F2F2; â€“txt2: #8A8A9A; â€“txt3: #3A3A4A;
â€“shadow: 0 4px 24px rgba(0,0,0,0.4);
â€“shadow2: 0 12px 48px rgba(0,0,0,0.55);
â€“shadow3: 0 24px 80px rgba(0,0,0,0.7);
â€“glass: rgba(24,24,32,0.82);
}

/* â€“ RESET â€“ */
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; -webkit-tap-highlight-color:transparent; }
html { height:100%; -webkit-font-smoothing:antialiased; }
body {
font-family: â€˜Outfitâ€™, sans-serif;
background: var(â€“bg);
color: var(â€“txt);
min-height: 100vh;
overflow-x: hidden;
transition: background .35s, color .35s;
}

/* â€“ GRAIN OVERLAY â€“ */
body::before {
content: â€˜â€™;
position: fixed; inset: 0; z-index: 0; pointer-events: none;
background-image: url(â€œdata:image/svg+xml,%3Csvg viewBox=â€˜0 0 256 256â€™ xmlns=â€˜http://www.w3.org/2000/svgâ€™%3E%3Cfilter id=â€˜noiseâ€™%3E%3CfeTurbulence type=â€˜fractalNoiseâ€™ baseFrequency=â€˜0.9â€™ numOctaves=â€˜4â€™ stitchTiles=â€˜stitchâ€™/%3E%3C/filter%3E%3Crect width=â€˜100%25â€™ height=â€˜100%25â€™ filter=â€˜url(%23noise)â€™ opacity=â€˜0.04â€™/%3E%3C/svg%3Eâ€);
opacity: .45;
}

/* â€“ ANIMATED MESH BACKGROUND â€“ */
.mesh {
position: fixed; inset: 0; z-index: 0; pointer-events: none;
overflow: hidden;
}
.mesh-orb {
position: absolute; border-radius: 50%;
filter: blur(100px);
animation: orbDrift 12s ease-in-out infinite alternate;
}
.m1 { width:600px;height:600px; background:radial-gradient(#833AB4, transparent 70%); top:-200px;right:-100px; opacity:.10; animation-duration:14s; }
.m2 { width:500px;height:500px; background:radial-gradient(#E1306C, transparent 70%); bottom:-100px;left:-150px; opacity:.09; animation-duration:18s; animation-delay:-6s; }
.m3 { width:400px;height:400px; background:radial-gradient(#F77737, transparent 70%); top:40%;left:30%; opacity:.07; animation-duration:20s; animation-delay:-10s; }
[data-theme=â€œdarkâ€] .mesh-orb { opacity: .15 !important; }
@keyframes orbDrift {
from { transform: translate(0,0) scale(1); }
to { transform: translate(40px, 30px) scale(1.08); }
}

/* â€“ APP CONTAINER â€“ */
.app {
position: relative; z-index: 1;
min-height: 100vh;
display: flex; flex-direction: column;
align-items: center; justify-content: center;
padding: 80px 16px 72px;
}

/* â€“ SCREENS â€“ */
.sc { display:none; width:100%; max-width:420px; flex-direction:column; align-items:center; gap:14px; }
.sc.on { display:flex; animation: scPop .5s cubic-bezier(.22,1,.36,1); }
@keyframes scPop {
from { opacity:0; transform:translateY(20px) scale(.97); }
to { opacity:1; transform:translateY(0) scale(1); }
}

/* â€“ TOPBAR â€“ */
#topbar {
position: fixed; top:0; left:0; right:0; z-index:400;
display: flex; align-items:center; justify-content:space-between;
padding: 12px 18px;
background: var(â€“glass);
backdrop-filter: var(â€“glass-b);
-webkit-backdrop-filter: var(â€“glass-b);
border-bottom: 1px solid var(â€“bord);
}
.tb-brand {
font-family: â€˜Syneâ€™, sans-serif; font-weight:900; font-size:20px;
letter-spacing:-0.5px;
background: var(â€“grad);
-webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
}
.tb-right { display:flex; gap:8px; align-items:center; }

.circ-btn {
width:36px; height:36px; border-radius:50%; border:none; cursor:pointer;
background: var(â€“surf2); border:1px solid var(â€“bord);
display:flex; align-items:center; justify-content:center;
font-size:16px; transition:all .22s; color:var(â€“txt2);
}
.circ-btn:hover { transform:scale(1.1); background:var(â€“surf3); }
.circ-btn:active { transform:scale(.93); }

#back-btn { display:none; font-size:12px; width:auto; padding:0 14px; border-radius:50px; font-weight:600; font-family:â€˜Outfitâ€™,sans-serif; color:var(â€“txt2); gap:4px; }
#back-btn.vis { display:flex; }

/* â€“ SETTINGS DRAWER â€“ */
.drawer-mask {
position:fixed; inset:0; z-index:498; background:rgba(0,0,0,.4);
backdrop-filter:blur(6px); display:none; opacity:0;
transition: opacity .3s;
}
.drawer-mask.on { display:block; opacity:1; }
#drawer {
position:fixed; top:0; right:0; bottom:0; width:300px; max-width:88vw;
z-index:499; background:var(â€“surf); border-left:1px solid var(â€“bord);
transform:translateX(110%); transition:transform .38s cubic-bezier(.22,1,.36,1);
padding:72px 22px 28px; overflow-y:auto;
box-shadow:-20px 0 60px rgba(0,0,0,.12);
}
#drawer.open { transform:translateX(0); }

.drawer-title { font-family:â€˜Syneâ€™,sans-serif; font-weight:800; font-size:20px; margin-bottom:22px; }
.d-row {
display:flex; align-items:center; justify-content:space-between;
padding:15px 0; border-bottom:1px solid var(â€“bord);
}
.d-label { font-size:14px; font-weight:600; }
.d-sub { font-size:11px; color:var(â€“txt2); margin-top:2px; }

/* Toggle */
.tog { position:relative; width:48px; height:27px; cursor:pointer; flex-shrink:0; }
.tog input { opacity:0; width:0; height:0; position:absolute; }
.tog-track { position:absolute; inset:0; border-radius:14px; background:var(â€“surf3); transition:background .25s; }
.tog input:checked + .tog-track { background: var(â€“grad); }
.tog-ball { position:absolute; top:3.5px; left:3.5px; width:20px; height:20px; border-radius:50%; background:#fff; box-shadow:0 2px 6px rgba(0,0,0,.2); transition:transform .25s cubic-bezier(.34,1.56,.64,1); }
.tog input:checked ~ .tog-ball { transform:translateX(21px); }

/* God input */
.god-wrap { padding:14px 0 0; }
.god-inp {
width:100%; padding:12px 16px; border-radius:12px;
background:var(â€“surf2); border:1.5px solid var(â€“bord);
color:var(â€“txt); font-family:â€˜Syneâ€™,sans-serif; font-size:18px; font-weight:700;
letter-spacing:8px; text-align:center; outline:none;
transition:border-color .2s, box-shadow .2s;
}
.god-inp:focus { border-color:#833AB4; box-shadow:0 0 0 4px rgba(131,58,180,.1); }
.god-msg { font-size:11px; font-weight:600; text-align:center; margin-top:8px; padding:6px 12px; border-radius:8px; display:none; }
.god-msg.ok { display:block; background:rgba(25,211,100,.1); color:#19d364; }
.god-msg.er { display:block; background:rgba(225,48,108,.1); color:#E1306C; }

/* â€“ LOGO â€“ */
.logo-wrap { text-align:center; }
.logo-icon {
width:88px; height:88px; border-radius:30px; margin:0 auto 18px;
background: var(â€“grad); display:flex; align-items:center; justify-content:center;
font-size:42px; box-shadow:0 16px 60px rgba(225,48,108,.35);
animation:iconFloat 4s ease-in-out infinite;
}
@keyframes iconFloat {
0%,100%{transform:translateY(0) rotate(0deg);}
33%{transform:translateY(-8px) rotate(-2deg);}
66%{transform:translateY(-4px) rotate(1deg);}
}
.logo-name {
font-family:â€˜Syneâ€™,sans-serif; font-weight:900;
font-size:clamp(48px,12vw,72px); letter-spacing:-3px; line-height:1;
background:var(â€“grad);
-webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
}
.logo-tagline { font-size:13px; color:var(â€“txt2); margin-top:8px; font-weight:500; letter-spacing:.3px; }

/* â€“ STATS STRIP â€“ */
.stats-strip { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; width:100%; }
.stat-box {
background:var(â€“surf); border:1px solid var(â€“bord); border-radius:var(â€“r2);
padding:14px 10px; text-align:center; box-shadow:var(â€“shadow);
transition:background .3s, border-color .3s;
}
.stat-n {
font-family:â€˜Syneâ€™,sans-serif; font-weight:900; font-size:26px;
background:var(â€“grad); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
}
.stat-l { font-size:10px; color:var(â€“txt2); font-weight:600; text-transform:uppercase; letter-spacing:1.2px; margin-top:2px; }

/* â€“ CARDS â€“ */
.card {
background:var(â€“surf); border:1px solid var(â€“bord);
border-radius:var(â€“r); padding:22px 20px; width:100%;
box-shadow:var(â€“shadow); transition:background .3s, box-shadow .3s;
}
.card-gradient {
background:var(â€“grad-soft);
border-color:rgba(225,48,108,.15);
}

/* â€“ BUTTONS â€“ */
.btn {
display:flex; align-items:center; justify-content:center; gap:8px;
padding:16px 20px; border-radius:50px; border:none;
font-family:â€˜Outfitâ€™,sans-serif; font-weight:700; font-size:15px;
cursor:pointer; transition:all .22s; width:100%; letter-spacing:.2px;
position:relative; overflow:hidden;
}
.btn:active { transform:scale(.96); }
.btn:disabled { opacity:.3; cursor:not-allowed; }

/* Shimmer on hover */
.btn::after {
content:â€™â€™; position:absolute; inset:0;
background:linear-gradient(90deg,transparent,rgba(255,255,255,.15),transparent);
transform:translateX(-100%); transition:transform .5s;
}
.btn:hover::after { transform:translateX(100%); }

.b-grad {
background:var(â€“grad); color:#fff;
box-shadow:0 6px 30px rgba(225,48,108,.4);
}
.b-grad:hover { box-shadow:0 10px 40px rgba(225,48,108,.55); transform:translateY(-1px); }

.b-out {
background:transparent; color:var(â€“txt);
border:1.5px solid var(â€“bord);
}
.b-out:hover { border-color:var(â€“txt3); background:var(â€“surf2); }

.b-ghost { background:var(â€“surf2); color:var(â€“txt2); }
.b-ghost:hover { color:var(â€“txt); }
.b-sm { padding:11px 18px; font-size:13px; }

/* â€“ FORM ELEMENTS â€“ */
.f-lbl { font-size:11px; font-weight:700; color:var(â€“txt2); text-transform:uppercase; letter-spacing:1.5px; display:block; margin-bottom:8px; }
.f-inp {
width:100%; padding:14px 18px; border-radius:var(â€“r2);
background:var(â€“surf2); border:1.5px solid var(â€“bord);
color:var(â€“txt); font-family:â€˜Outfitâ€™,sans-serif; font-size:15px; font-weight:500;
outline:none; transition:all .22s;
}
.f-inp:focus { border-color:#E1306C; box-shadow:0 0 0 4px rgba(225,48,108,.08); background:var(â€“surf); }
.f-inp::placeholder { color:var(â€“txt3); }

.f-inp-code {
text-align:center; font-family:â€˜Syneâ€™,sans-serif; font-size:28px; font-weight:900;
letter-spacing:10px; color:transparent;
background:var(â€“grad); -webkit-background-clip:text;
-webkit-text-fill-color:transparent; background-clip:text;
caret-color:#E1306C;
}
.f-inp-code::placeholder { -webkit-text-fill-color:var(â€“txt3); font-size:14px; letter-spacing:3px; font-weight:400; }

.f-select {
width:100%; padding:14px 40px 14px 18px; border-radius:var(â€“r2);
background:var(â€“surf2); border:1.5px solid var(â€“bord);
color:var(â€“txt); font-family:â€˜Outfitâ€™,sans-serif; font-size:15px; font-weight:500;
outline:none; cursor:pointer; appearance:none;
background-image:url(â€œdata:image/svg+xml,%3Csvg xmlns=â€˜http://www.w3.org/2000/svgâ€™ width=â€˜12â€™ height=â€˜8â€™%3E%3Cpath d=â€˜M1 1l5 5 5-5â€™ stroke=â€™%23999â€™ stroke-width=â€˜1.5â€™ fill=â€˜noneâ€™ stroke-linecap=â€˜roundâ€™/%3E%3C/svg%3Eâ€);
background-repeat:no-repeat; background-position:right 16px center;
transition:all .22s;
}
.f-select:focus { border-color:#E1306C; box-shadow:0 0 0 4px rgba(225,48,108,.08); }
.f-select option { background:var(â€“surf); }

/* â€“ DIFFICULTY PILLS â€“ */
.diff-row { display:grid; grid-template-columns:repeat(3,1fr); gap:8px; }
.diff-pill {
padding:12px 8px; border-radius:14px; border:1.5px solid var(â€“bord);
background:var(â€“surf2); cursor:pointer; text-align:center;
transition:all .22s; user-select:none;
}
.diff-pill * { pointer-events:none; }
.diff-pill .de { font-size:20px; display:block; }
.diff-pill .dn { font-size:10px; font-weight:800; margin-top:4px; display:block; color:var(â€“txt2); text-transform:uppercase; letter-spacing:.5px; }
.diff-pill.sel-e { border-color:#19d364; background:rgba(25,211,100,.07); }
.diff-pill.sel-m { border-color:#F77737; background:rgba(247,119,55,.07); }
.diff-pill.sel-h { border-color:#E1306C; background:rgba(225,48,108,.07); }

/* â€“ CODE BOX â€“ */
.code-box {
background:var(â€“surf2); border:1.5px solid rgba(225,48,108,.2);
border-radius:var(â€“r2); padding:20px 18px; text-align:center; width:100%;
}
.code-val {
display:block; font-family:â€˜Syneâ€™,sans-serif; font-weight:900; font-size:40px;
letter-spacing:12px; background:var(â€“grad);
-webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
filter:drop-shadow(0 2px 12px rgba(225,48,108,.25));
}
.code-copy { font-size:11px; color:var(â€“txt2); font-weight:600; cursor:pointer; margin-top:6px; letter-spacing:.5px; transition:color .2s; }
.code-copy:hover { color:#E1306C; }

/* â€“ PLAYER CARDS â€“ */
.players-row { display:flex; gap:10px; width:100%; }
.p-card {
flex:1; background:var(â€“surf); border:1.5px solid var(â€“bord);
border-radius:var(â€“r2); padding:16px 12px; text-align:center;
transition:all .3s;
}
.p-card.me { border-image:var(â€“grad) 1; border-image-slice:1; }
.p-card.ready { border-color:#19d364; background:rgba(25,211,100,.04); }
.p-av {
width:48px; height:48px; border-radius:50%; margin:0 auto 10px;
display:flex; align-items:center; justify-content:center; font-size:24px;
}
.av-1 { background:var(â€“grad); }
.av-2 { background:linear-gradient(135deg,#00b09b,#96c93d); }
.av-e { background:var(â€“surf3); animation:avPulse 1.5s ease-in-out infinite; }
@keyframes avPulse { 0%,100%{opacity:.5} 50%{opacity:1} }
.p-name { font-weight:700; font-size:14px; }
.p-status { font-size:11px; color:var(â€“txt2); margin-top:3px; }

/* â€“ WORD DISPLAY â€“ */
.word-card {
background:var(â€“surf); border:1px solid var(â€“bord);
border-radius:var(â€“r); padding:22px 18px; width:100%;
position:relative; overflow:hidden; box-shadow:var(â€“shadow);
}
.word-card::after {
content:â€™â€™; position:absolute; bottom:0; left:0; right:0; height:3px;
background:var(â€“grad);
}
.wc-top { display:flex; justify-content:space-between; align-items:center; margin-bottom:18px; }
.cat-pill {
padding:5px 14px; border-radius:50px; font-size:11px; font-weight:700;
background:var(â€“grad); color:#fff; letter-spacing:.5px; text-transform:uppercase;
}
.pts-badge {
font-family:â€˜Syneâ€™,sans-serif; font-size:15px; font-weight:900;
background:var(â€“grad); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
}

/* Blanks row */
.blanks { display:flex; flex-wrap:wrap; gap:6px; justify-content:center; margin:14px 0 16px; }
.blank {
width:36px; height:44px; border-bottom:2.5px solid var(â€“surf3);
display:flex; align-items:flex-end; justify-content:center; padding-bottom:4px;
font-family:â€˜Syneâ€™,sans-serif; font-size:22px; font-weight:900;
transition:all .3s; color:var(â€“txt);
}
.blank.lit {
border-color:#E1306C; color:#E1306C;
animation:blankReveal .5s cubic-bezier(.34,1.56,.64,1);
}
.blank.sp { width:10px; border:none; }
@keyframes blankReveal {
0% { transform:scale(0) rotateX(90deg); opacity:0; }
60% { transform:scale(1.2) rotateX(0); opacity:1; }
100% { transform:scale(1); }
}
.word-meta { font-size:12px; color:var(â€“txt2); text-align:center; font-weight:500; }

/* â€“ HINTS â€“ */
.hints-list { display:flex; flex-direction:column; gap:8px; width:100%; }
.hint-item {
display:flex; gap:10px; align-items:flex-start;
background:var(â€“surf); border:1px solid var(â€“bord);
border-radius:var(â€“r3); padding:12px 14px;
animation:hintIn .4s cubic-bezier(.22,1,.36,1);
box-shadow:var(â€“shadow);
}
@keyframes hintIn { from{opacity:0;transform:translateX(-14px)} to{opacity:1;transform:translateX(0)} }
.hint-icon {
width:34px; height:34px; border-radius:10px; flex-shrink:0;
background:var(â€“grad); display:flex; align-items:center; justify-content:center;
font-size:15px;
}
.hint-label { font-size:10px; font-weight:700; color:var(â€“txt2); text-transform:uppercase; letter-spacing:1.5px; }
.hint-text { font-size:14px; font-weight:500; line-height:1.4; color:var(â€“txt); margin-top:2px; }
.no-hint {
padding:20px; text-align:center; border:1.5px dashed var(â€“bord); border-radius:var(â€“r3);
font-size:12px; color:var(â€“txt2); font-weight:500;
}

/* Hint countdown bar */
.hint-bar-wrap {
display:flex; gap:10px; align-items:center; width:100%;
background:var(â€“surf2); border-radius:10px; padding:10px 14px;
}
.hint-bar-track { flex:1; height:4px; background:var(â€“surf3); border-radius:4px; overflow:hidden; }
.hint-bar-fill { height:100%; background:var(â€“grad); border-radius:4px; transition:width .5s linear; }
.hint-bar-lbl { font-size:11px; color:var(â€“txt2); font-weight:600; white-space:nowrap; }

/* â€“ GUESS FEED â€“ */
.guess-feed {
display:flex; flex-direction:column; gap:6px; max-height:190px; overflow-y:auto; width:100%;
}
.guess-feed::-webkit-scrollbar { width:3px; }
.guess-feed::-webkit-scrollbar-thumb { background:var(â€“bord); border-radius:4px; }
.g-item {
display:flex; align-items:center; justify-content:space-between;
padding:10px 14px; border-radius:12px;
border:1.5px solid var(â€“bord); background:var(â€“surf);
animation:gIn .25s cubic-bezier(.22,1,.36,1);
}
@keyframes gIn { from{opacity:0;transform:scale(.95)} to{opacity:1;transform:scale(1)} }
.g-item.g-win { border-color:#19d364; background:rgba(25,211,100,.06); }
.g-item.g-close { border-color:#F77737; background:rgba(247,119,55,.06); }
.g-who { font-size:12px; font-weight:700; }
.g-word { font-family:â€˜Syneâ€™,sans-serif; font-weight:800; font-size:13px; letter-spacing:.8px; }
.g-icon { font-size:17px; }

/* â€“ GUESS INPUT â€“ */
.guess-row { display:flex; gap:8px; width:100%; }
.guess-inp {
flex:1; padding:14px 18px; border-radius:var(â€“r2);
background:var(â€“surf2); border:1.5px solid var(â€“bord);
color:var(â€“txt); font-family:â€˜Syneâ€™,sans-serif;
font-size:22px; font-weight:900; letter-spacing:4px;
text-align:center; text-transform:uppercase; outline:none;
transition:all .22s;
}
.guess-inp:focus { border-color:#E1306C; box-shadow:0 0 0 4px rgba(225,48,108,.08); background:var(â€“surf); }
.guess-inp::placeholder { font-size:13px; letter-spacing:2px; font-weight:400; color:var(â€“txt3); }
.guess-btn {
width:54px; height:54px; border-radius:18px; border:none; flex-shrink:0;
background:var(â€“grad); color:#fff; font-size:22px;
cursor:pointer; display:flex; align-items:center; justify-content:center;
box-shadow:0 4px 20px rgba(225,48,108,.4); transition:all .22s;
}
.guess-btn:hover { transform:scale(1.08); box-shadow:0 6px 28px rgba(225,48,108,.55); }
.guess-btn:active { transform:scale(.94); }

/* â€“ GOD PEEK â€“ */
.god-peek {
display:none; width:100%; padding:12px 18px; border-radius:var(â€“r3); text-align:center;
border:1.5px dashed #833AB4; background:rgba(131,58,180,.06);
font-family:â€˜Syneâ€™,sans-serif; font-weight:900; font-size:22px;
letter-spacing:4px; color:#833AB4;
animation:godGlow 2.5s ease-in-out infinite;
}
.god-peek.on { display:block; }
@keyframes godGlow {
0%,100%{box-shadow:0 0 0 0 rgba(131,58,180,.15)}
50%{box-shadow:0 0 24px rgba(131,58,180,.3)}
}

/* â€“ FOUND BANNER â€“ */
.found-banner {
display:none; padding:14px; width:100%; text-align:center;
background:rgba(25,211,100,.08); border:1.5px solid #19d364; border-radius:var(â€“r3);
font-weight:700; font-size:14px; color:#19d364;
}
.found-banner.on { display:block; animation:hintIn .4s ease; }

/* â€“ TIMER â€“ */
.timer-wrap { display:flex; align-items:center; gap:12px; }
.timer-ring { position:relative; width:50px; height:50px; flex-shrink:0; }
.timer-ring svg { transform:rotate(-90deg); }
.timer-ring circle { stroke-dasharray:138; stroke-dashoffset:0; transition:stroke-dashoffset 1s linear, stroke .5s; }
#t-num {
position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
font-family:â€˜Syneâ€™,sans-serif; font-size:13px; font-weight:900; color:var(â€“txt);
}
.timer-info .t-label { font-size:9px; font-weight:700; color:var(â€“txt2); text-transform:uppercase; letter-spacing:1.5px; }
.timer-info .t-val { font-family:â€˜Syneâ€™,sans-serif; font-weight:900; font-size:20px; background:var(â€“grad); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text; }

/* â€“ WINNER OVERLAY â€“ */
#win-overlay {
position:fixed; inset:0; z-index:600;
display:none; align-items:flex-end; justify-content:center;
padding:0 16px 24px;
}
#win-overlay.on { display:flex; animation:fadeIn .3s ease; }
@keyframes fadeIn { from{opacity:0} to{opacity:1} }
#win-overlay::before {
content:â€™â€™; position:fixed; inset:0;
background:rgba(0,0,0,.6); backdrop-filter:blur(12px);
-webkit-backdrop-filter:blur(12px); z-index:-1;
}
.win-sheet {
background:var(â€“surf); border:1px solid var(â€“bord);
border-radius:28px 28px 20px 20px;
padding:28px 22px 22px; width:100%; max-width:420px;
box-shadow:var(â€“shadow3); text-align:center;
animation:sheetUp .5s cubic-bezier(.22,1,.36,1);
}
@keyframes sheetUp { from{transform:translateY(100%)} to{transform:translateY(0)} }
.win-handle { width:44px; height:5px; background:var(â€“surf3); border-radius:4px; margin:0 auto 20px; }
.win-em { font-size:72px; margin-bottom:6px; display:block; animation:emBounce 1s ease-in-out infinite; }
@keyframes emBounce { 0%,100%{transform:translateY(0) scale(1)} 50%{transform:translateY(-12px) scale(1.1)} }
.win-title {
font-family:â€˜Syneâ€™,sans-serif; font-weight:900; font-size:30px; letter-spacing:-1px;
background:var(â€“grad); -webkit-background-clip:text; -webkit-text-fill-color:transparent; background-clip:text;
margin-bottom:6px;
}
.win-sub { font-size:14px; color:var(â€“txt2); line-height:1.6; margin-bottom:20px; }
.win-word {
padding:16px; background:var(â€“grad); border-radius:16px;
font-family:â€˜Syneâ€™,sans-serif; font-weight:900; font-size:24px;
letter-spacing:5px; color:#fff; margin-bottom:20px;
box-shadow:0 8px 30px rgba(225,48,108,.35);
}

/* â€“ LOADING SCREEN â€“ */
#loader {
position:fixed; inset:0; z-index:9999;
background:var(â€“bg); display:flex; flex-direction:column;
align-items:center; justify-content:center; gap:0;
transition:opacity .6s, visibility .6s;
}
#loader.out { opacity:0; visibility:hidden; }
.ld-logo {
width:80px; height:80px; border-radius:26px; background:var(â€“grad);
display:flex; align-items:center; justify-content:center; font-size:40px;
animation:ldPulse 1.2s ease-in-out infinite;
box-shadow:0 16px 60px rgba(225,48,108,.4);
}
@keyframes ldPulse { 0%,100%{transform:scale(1);opacity:1} 50%{transform:scale(1.06);opacity:.85} }
.ld-name {
font-family:â€˜Syneâ€™,sans-serif; font-weight:900; font-size:28px;
background:var(â€“grad); -webkit-background-clip:text; -webkit-text-fill-color:transparent;
background-clip:text; margin-top:14px;
}
.ld-dots { display:flex; gap:7px; margin-top:22px; }
.ld-dot { width:9px; height:9px; border-radius:50%; animation:ldDot 1.1s ease-in-out infinite; }
.ld-dot:nth-child(1) { background:#833AB4; }
.ld-dot:nth-child(2) { background:#E1306C; animation-delay:.2s; }
.ld-dot:nth-child(3) { background:#F77737; animation-delay:.4s; }
@keyframes ldDot { 0%,80%,100%{transform:scale(.7);opacity:.3} 40%{transform:scale(1.2);opacity:1} }

/* â€“ WAITING INDICATOR â€“ */
.wait-dots { display:flex; gap:6px; justify-content:center; margin-top:10px; }
.wdot { width:8px; height:8px; border-radius:50%; animation:ldDot 1.1s ease-in-out infinite; }
.wdot:nth-child(1){background:#833AB4;}
.wdot:nth-child(2){background:#E1306C;animation-delay:.18s;}
.wdot:nth-child(3){background:#F77737;animation-delay:.36s;}

/* â€“ TOAST â€“ */
#toast {
position:fixed; top:68px; left:50%;
transform:translateX(-50%) translateY(-110px);
padding:12px 22px; border-radius:50px; z-index:9998;
font-family:â€˜Outfitâ€™,sans-serif; font-weight:700; font-size:14px;
white-space:nowrap; max-width:92vw; text-align:center;
pointer-events:none; box-shadow:var(â€“shadow3);
transition:transform .38s cubic-bezier(.34,1.56,.64,1);
}
#toast.up { transform:translateX(-50%) translateY(0); }
#toast.ok { background:#19d364; color:#fff; }
#toast.er { background:linear-gradient(135deg,#E1306C,#F77737); color:#fff; }
#toast.if { background:var(â€“surf); color:var(â€“txt); border:1px solid var(â€“bord); }
#toast.gd { background:var(â€“grad); color:#fff; }

/* â€“ FOOTER â€“ */
footer {
position:fixed; bottom:0; left:0; right:0; z-index:100;
text-align:center; padding:10px 16px;
font-size:11px; color:var(â€“txt3); font-weight:500;
background:var(â€“glass); backdrop-filter:var(â€“glass-b);
-webkit-backdrop-filter:var(â€“glass-b);
border-top:1px solid var(â€“bord);
}

/* â€“ MISC â€“ */
.col { display:flex; flex-direction:column; gap:10px; width:100%; }
.row { display:flex; gap:8px; align-items:center; }
.w100 { width:100%; } .tc { text-align:center; }
.mt4{margin-top:4px;} .mt8{margin-top:8px;} .mt12{margin-top:12px;}
.shk { animation:shk .4s ease; }
@keyframes shk {0%,100%{transform:translateX(0)}20%{transform:translateX(-8px)}40%{transform:translateX(8px)}60%{transform:translateX(-5px)}80%{transform:translateX(4px)}}
@keyframes confPop { to{transform:translateY(110vh) rotate(720deg);opacity:0} }
</style>

</head>
<body>

<!-- -- MESH BACKGROUND -- -->

<div class="mesh">
<div class="mesh-orb m1"></div>
<div class="mesh-orb m2"></div>
<div class="mesh-orb m3"></div>
</div>

<!-- -- LOADING SCREEN -- -->

<div id="loader">
<div class="ld-logo">ğŸ”¤</div>
<div class="ld-name">LEXIS</div>
<div class="ld-dots">
<div class="ld-dot"></div>
<div class="ld-dot"></div>
<div class="ld-dot"></div>
</div>
</div>

<!-- -- TOPBAR -- -->

<div id="topbar">
<button class="circ-btn" id="back-btn">â† Retour</button>
<div class="tb-brand">LEXIS</div>
<div class="tb-right">
<button class="circ-btn" id="theme-btn" title="ThÃ¨me">ğŸŒ™</button>
<button class="circ-btn" id="settings-btn" title="ParamÃ¨tres">âš™ï¸</button>
</div>
</div>

<!-- -- SETTINGS DRAWER -- -->

<div class="drawer-mask" id="dmask"></div>
<div id="drawer">
<div class="drawer-title">âš™ï¸ ParamÃ¨tres</div>

<div class="d-row">
<div><div class="d-label">Mode sombre</div><div class="d-sub">Interface noire</div></div>
<label class="tog"><input type="checkbox" id="dark-chk"><div class="tog-track"></div><div class="tog-ball"></div></label>
</div>
<div class="d-row">
<div><div class="d-label">Mode rapide âš¡</div><div class="d-sub">Indice toutes les 10s</div></div>
<label class="tog"><input type="checkbox" id="speed-chk"><div class="tog-track"></div><div class="tog-ball"></div></label>
</div>
<div class="d-row">
<div><div class="d-label">Sons ğŸ”Š</div><div class="d-sub">Effets sonores</div></div>
<label class="tog"><input type="checkbox" id="sound-chk" checked><div class="tog-track"></div><div class="tog-ball"></div></label>
</div>

<!-- GOD MODE -->

<div class="d-row" style="flex-direction:column;align-items:flex-start;gap:10px;">
<div>
<div class="d-label" style="background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">âš¡ Mode CrÃ©ateur</div>
<div class="d-sub">Code secret - vois le mot en jeu</div>
</div>
<div class="god-wrap w100">
<input class="god-inp" id="god-inp" type="password" placeholder="* * * * * *" maxlength="12">
<div class="god-msg" id="god-msg"></div>
</div>
</div>

<div style="margin-top:28px;text-align:center;">
<div style="font-size:11px;color:var(--txt3);">LEXIS v1.0 * Firebase * 2026</div>
</div>
</div>

<!-- -- WINNER OVERLAY -- -->

<div id="win-overlay">
<div class="win-sheet">
<div class="win-handle"></div>
<span class="win-em" id="we">ğŸ†</span>
<div class="win-title" id="wt">Victoire !</div>
<div class="win-sub" id="ws">Tu as trouvÃ© le mot en premier !</div>
<div class="win-word" id="ww">MOT</div>
<div class="col" style="gap:8px;">
<button class="btn b-grad" id="btn-replay">ğŸ”„ Rejouer</button>
<button class="btn b-ghost b-sm" id="btn-quit-w">Quitter la partie</button>
</div>
</div>
</div>

<!-- -- TOAST -- -->

<div id="toast"></div>

<!-- ========== APP ========== -->

<div class="app">

<!-- === HOME === -->

<div id="s-home" class="sc on">
<div class="logo-wrap">
<div class="logo-icon">ğŸ”¤</div>
<div class="logo-name">LEXIS</div>
<div class="logo-tagline">Le jeu de mots multijoueur ultime âœ¨</div>
</div>

<div class="stats-strip">
<div class="stat-box"><div class="stat-n" id="h-wins">0</div><div class="stat-l">Victoires</div></div>
<div class="stat-box"><div class="stat-n" id="h-played">0</div><div class="stat-l">Parties</div></div>
<div class="stat-box"><div class="stat-n" id="h-streak">0ğŸ”¥</div><div class="stat-l">SÃ©rie</div></div>
</div>

<div class="col">
<button class="btn b-grad" id="btn-go-create">âœ¨ CrÃ©er une partie</button>
<button class="btn b-out" id="btn-go-join">ğŸš€ Rejoindre une partie</button>
</div>

<div class="card card-gradient">
<div style="display:flex;align-items:center;gap:10px;margin-bottom:10px;">
<div style="width:34px;height:34px;border-radius:10px;background:var(--grad);display:flex;align-items:center;justify-content:center;font-size:15px;flex-shrink:0;">ğŸ“–</div>
<div style="font-weight:700;font-size:14px;">Comment jouer</div>
</div>
<div style="font-size:12px;color:var(--txt2);line-height:1.9;">
1ï¸âƒ£ CrÃ©e ou rejoins une partie<br>
2ï¸âƒ£ Attends le 2e joueur avec le code<br>
3ï¸âƒ£ ReÃ§ois des indices progressifs<br>
4ï¸âƒ£ <strong style="color:var(--txt)">Devine le mot avant l'adversaire !</strong>
</div>
</div>
</div>

<!-- === CREATE === -->

<div id="s-create" class="sc">
<div class="logo-wrap" style="padding:0;">
<div class="logo-icon" style="width:66px;height:66px;border-radius:22px;font-size:30px;margin-bottom:12px;box-shadow:none;">âœ¨</div>
<div class="logo-name" style="font-size:32px;">Nouvelle partie</div>
</div>
<div class="card">
<div class="col">
<div>
<span class="f-lbl">Ton pseudo</span>
<input class="f-inp" id="c-name" type="text" placeholder="Ex : Shadow42" maxlength="16" autocomplete="off">
</div>
<div>
<span class="f-lbl">CatÃ©gorie</span>
<select class="f-select" id="c-cat">
<option value="mix">ğŸŒ Tout mÃ©langer</option>
<option value="animal">ğŸ¾ Animaux</option>
<option value="pays">ğŸŒ Pays du monde</option>
<option value="sport">âš½ Sports</option>
<option value="objet">ğŸ”§ Objets</option>
<option value="food">ğŸ• Nourriture</option>
<option value="science">ğŸ”¬ Science</option>
<option value="celeb">ğŸ¬ PersonnalitÃ©s</option>
</select>
</div>
<div>
<span class="f-lbl">DifficultÃ©</span>
<div class="diff-row">
<div class="diff-pill sel-e" data-d="easy"><span class="de">ğŸ˜Š</span><span class="dn">Facile</span></div>
<div class="diff-pill" data-d="med" ><span class="de">ğŸ”¥</span><span class="dn">Moyen</span></div>
<div class="diff-pill" data-d="hard"><span class="de">ğŸ’€</span><span class="dn">Difficile</span></div>
</div>
</div>
<button class="btn b-grad" id="btn-create-ok">CrÃ©er la partie âœ¨</button>
<button class="btn b-ghost b-sm" id="btn-create-back">â† Retour</button>
</div>
</div>
</div>

<!-- === JOIN === -->

<div id="s-join" class="sc">
<div class="logo-wrap" style="padding:0;">
<div class="logo-icon" style="width:66px;height:66px;border-radius:22px;font-size:30px;margin-bottom:12px;box-shadow:none;background:linear-gradient(135deg,#00b09b,#96c93d);">ğŸš€</div>
<div class="logo-name" style="font-size:32px;background:linear-gradient(135deg,#00b09b,#96c93d);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Rejoindre</div>
</div>
<div class="card">
<div class="col">
<div>
<span class="f-lbl">Ton pseudo</span>
<input class="f-inp" id="j-name" type="text" placeholder="Ex : Ninja99" maxlength="16" autocomplete="off">
</div>
<div>
<span class="f-lbl">Code de la partie</span>
<input class="f-inp f-inp-code" id="j-code" type="text" placeholder="XXXX" maxlength="4">
</div>
<button class="btn b-grad" id="btn-join-ok">Rejoindre ğŸš€</button>
<button class="btn b-ghost b-sm" id="btn-join-back">â† Retour</button>
</div>
</div>
</div>

<!-- === LOBBY === -->

<div id="s-lobby" class="sc">
<div class="tc w100">
<div class="f-lbl tc">Code de la partie</div>
<div class="code-box">
<span class="code-val" id="l-code">----</span>
<div class="code-copy" id="l-copy">ğŸ“‹ Appuyer pour copier</div>
</div>
</div>

<div class="players-row" id="l-players"></div>

<div class="card tc">
<div style="font-weight:700;font-size:14px;margin-bottom:10px;" id="l-status-txt"></div>
<div class="wait-dots" id="l-wait">
<div class="wdot"></div><div class="wdot"></div><div class="wdot"></div>
</div>
<button class="btn b-grad mt8" id="l-start" style="display:none;margin-top:14px;">âš¡ Lancer !</button>
</div>

<div class="f-lbl tc" id="l-info" style="font-size:10px;color:var(--txt2);line-height:2;"></div>
</div>

<!-- === GAME === -->

<div id="s-game" class="sc" style="max-width:480px;gap:10px;">

<!-- En-tÃªte manche -->

<div style="display:flex;justify-content:space-between;align-items:center;width:100%;padding:0 2px;">
<div>
<div style="font-size:9px;font-weight:700;color:var(--txt2);text-transform:uppercase;letter-spacing:2px;">Statut</div>
<div id="g-status" style="font-family:'Syne',sans-serif;font-weight:900;font-size:16px;">En jeu</div>
</div>
<div class="timer-wrap">
<div class="timer-info">
<div class="t-label">Temps</div>
<div class="t-val" id="t-display">2:00</div>
</div>
<div class="timer-ring">
<svg width="50" height="50" viewBox="0 0 50 50">
<circle cx="25" cy="25" r="22" fill="none" stroke="var(--surf3)" stroke-width="3.5"/>
<circle id="t-arc" cx="25" cy="25" r="22" fill="none" stroke="#E1306C" stroke-width="3.5" stroke-linecap="round"/>
</svg>
<span id="t-num">--</span>
</div>
</div>
</div>

<!-- Progress bar -->

<div style="height:3px;background:var(--surf3);border-radius:4px;overflow:hidden;width:100%;">
<div id="g-prog" style="height:100%;background:var(--grad);border-radius:4px;transition:width .6s;width:0%;"></div>
</div>

<!-- God peek -->

<div class="god-peek" id="god-peek"></div>

<!-- Mot cachÃ© -->

<div class="word-card">
<div class="wc-top">
<span class="cat-pill" id="g-cat">CatÃ©gorie</span>
<span class="pts-badge" id="g-pts">â­ 100 pts</span>
</div>
<div class="blanks" id="g-blanks"></div>
<div class="word-meta" id="g-word-meta"></div>
</div>

<!-- Indices -->

<div class="w100">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
<span class="f-lbl" style="margin:0;">Indices reÃ§us</span>
<span id="g-hint-n" style="font-size:11px;color:var(--txt2);font-weight:600;"></span>
</div>
<div class="hints-list" id="g-hints">
<div class="no-hint">â³ Premier indice dans quelques secondes...</div>
</div>
</div>

<!-- Barre prochain indice -->

<div class="hint-bar-wrap" id="g-hint-bar" style="display:none;">
<span style="font-size:13px;">ğŸ’¡</span>
<div class="hint-bar-track"><div class="hint-bar-fill" id="g-bar-fill" style="width:0%;"></div></div>
<span class="hint-bar-lbl" id="g-bar-txt">20s</span>
</div>

<!-- Tentatives -->

<div class="w100">
<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
<span class="f-lbl" style="margin:0;">Tentatives</span>
<span id="g-att-n" style="font-size:11px;color:var(--txt2);font-weight:600;"></span>
</div>
<div class="guess-feed" id="g-feed">
<div style="padding:14px;text-align:center;font-size:12px;color:var(--txt2);">Aucune tentative pour l'instant</div>
</div>
</div>

<!-- Input devinette -->

<div id="g-input-zone" class="w100">
<div class="guess-row">
<input class="guess-inp" id="g-inp" type="text" placeholder="TON MOT..." maxlength="32">
<button class="guess-btn" id="g-send">â¤</button>
</div>
</div>
<div class="found-banner" id="g-found">âœ… Bien jouÃ© ! En attente de l'adversaire...</div>

</div>

<!-- === END === -->

<div id="s-end" class="sc">
<div class="tc" style="padding:12px 0;">
<div style="font-size:80px;margin-bottom:10px;">ğŸ†</div>
<div style="font-family:'Syne',sans-serif;font-weight:900;font-size:30px;letter-spacing:-1px;background:var(--grad);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;">Fin de partie !</div>
<div style="font-size:14px;color:var(--txt2);margin-top:8px;" id="e-sub"></div>
</div>
<div id="e-scores" class="w100"></div>
<div class="col" style="gap:8px;">
<button class="btn b-grad" id="btn-end-replay">ğŸ”„ Rejouer</button>
<button class="btn b-ghost b-sm" id="btn-end-home">ğŸ  Accueil</button>
</div>
</div>

</div><!-- /app -->

<footer>LEXIS * Jeu de mots multijoueur * 2026 ğŸš€</footer>

<script>
'use strict';

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 1. THÃˆME - appliquÃ© avant le DOM
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const isDarkStored = localStorage.getItem('lexis_dark') === '1';
document.documentElement.setAttribute('data-theme', isDarkStored ? 'dark' : 'light');
let isDark = isDarkStored;

function applyTheme(dark) {
isDark = dark;
document.documentElement.setAttribute('data-theme', dark ? 'dark' : 'light');
localStorage.setItem('lexis_dark', dark ? '1' : '0');
const btn = document.getElementById('theme-btn');
const chk = document.getElementById('dark-chk');
if (btn) btn.textContent = dark ? 'â˜€ï¸' : 'ğŸŒ™';
if (chk) chk.checked = dark;
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 2. FIREBASE
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
let db = null, fbReady = false;
(function loadFirebase() {
const s1 = document.createElement('script');
s1.src = 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js';
s1.async = true;
s1.onload = () => {
const s2 = document.createElement('script');
s2.src = 'https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js';
s2.async = true;
s2.onload = () => {
try {
if (!firebase.apps.length) {
firebase.initializeApp({
apiKey: "AIzaSyAWW-rnF1dqdCc5kCuI-d9dTSMrBJCrSb0",
authDomain: "test-a5848.firebaseapp.com",
databaseURL: "https://test-a5848-default-rtdb.europe-west1.firebasedatabase.app",
projectId: "test-a5848",
storageBucket: "test-a5848.firebasestorage.app",
messagingSenderId: "704331097703",
appId: "1:704331097703:web:613a8f735e863a312316c2"
});
}
db = firebase.database();
fbReady = true;
} catch(e) { console.error('Firebase init:', e); }
};
document.head.appendChild(s2);
};
document.head.appendChild(s1);
})();
function whenFB(fn) { fbReady ? fn() : setTimeout(() => whenFB(fn), 80); }

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 3. BASE DE MOTS
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const WORDS = {
animal: {
easy: [
{ w:'CHAT', c:'Animal ğŸ¾', h:['Animal domestique trÃ¨s populaire','Il ronronne quand il est heureux','Fait "miaou"'], d:'FÃ©lin domestique' },
{ w:'CHIEN', c:'Animal ğŸ¾', h:['Meilleur ami de l\'homme','Il aboie et remue la queue','FidÃ¨le gardien de la maison'], d:'CanidÃ© domestique' },
{ w:'LAPIN', c:'Animal ğŸ¾', h:['Il a de longues oreilles','Aime les carottes et la salade','Symbole de PÃ¢ques'], d:'Petit mammifÃ¨re aux longues oreilles' },
{ w:'LION', c:'Animal ğŸ¾', h:['Roi de la jungle','Sa criniÃ¨re est impressionnante','Rugit trÃ¨s fort - Simba !'], d:'Grand fÃ©lin africain' },
{ w:'DAUPHIN', c:'Animal ğŸ¾', h:['MammifÃ¨re marin trÃ¨s intelligent','Communique avec des ultrasons','Adore jouer avec les bateaux'], d:'CÃ©tacÃ© intelligent et joueur' },
{ w:'ELEPHANT', c:'Animal ğŸ¾', h:['Le plus grand animal terrestre','A une trÃ¨s longue mÃ©moire','Ses dÃ©fenses sont en ivoire'], d:'Grand mammifÃ¨re Ã  trompe' },
{ w:'PERROQUET', c:'Animal ğŸ¾', h:['Oiseau colorÃ© qui parle','Vit souvent sur l\'Ã©paule des pirates','Peut imiter la voix humaine'], d:'Oiseau capable de rÃ©pÃ©ter les mots' },
],
med: [
{ w:'FENNEC', c:'Animal ğŸ¾', h:['Petit renard du dÃ©sert','A d\'immenses oreilles relatives Ã  sa taille','Nocturne et vif dans le Sahara'], d:'Petit renard du dÃ©sert aux grandes oreilles' },
{ w:'AXOLOTL', c:'Animal ğŸ¾', h:['Amphibien mexicain Ã©trange','Ressemble Ã  une larve permanente','Rose, noir ou albinos'], d:'Amphibien nÃ©otÃ©nique du Mexique' },
{ w:'CAPYBARA', c:'Animal ğŸ¾', h:['Le plus grand rongeur du monde','TrÃ¨s calme, ami de tous les animaux','Originaire d\'AmÃ©rique du Sud'], d:'Le plus grand rongeur existant' },
{ w:'QUOKKA', c:'Animal ğŸ¾', h:['Petit marsupial australien','Toujours l\'air de sourire','Selfie animal le plus cÃ©lÃ¨bre d\'Internet'], d:'Marsupial australien au "sourire" cÃ©lÃ¨bre' },
],
hard: [
{ w:'COELACANTHE', c:'Animal ğŸ¾', h:['Poisson considÃ©rÃ© Ã©teint 65 M d\'ans','RedÃ©couvert en 1938 au large de l\'Afrique','Nageoires lobÃ©es articulÃ©es'], d:'Poisson fossile vivant' },
{ w:'TARDIGRADE', c:'Animal ğŸ¾', h:['Survit dans le vide de l\'espace','8 pattes, microscopique','L\'animal le plus rÃ©sistant connu'], d:'Micro-animal extrÃªmement rÃ©sistant' },
{ w:'BINTURONG', c:'Animal ğŸ¾', h:['Sent le popcorn naturellement','MammifÃ¨re arboricole d\'Asie','Aussi appelÃ© "ours chat"'], d:'MammifÃ¨re d\'Asie Ã  l\'odeur de popcorn' },
]
},
pays: {
easy: [
{ w:'JAPON', c:'Pays ğŸŒ', h:['Pays du Soleil Levant','Inventeur des mangas et sushis','Capitale : Tokyo'], d:'Archipel d\'Asie de l\'Est' },
{ w:'BRESIL', c:'Pays ğŸŒ', h:['5x champion du monde de football','Parle portugais','ForÃªt amazonienne massive'], d:'Plus grand pays d\'AmÃ©rique du Sud' },
{ w:'EGYPTE', c:'Pays ğŸŒ', h:['Pays des pharaons et pyramides','Le Nil la traverse du sud au nord','Abrite le Sphinx'], d:'Berceau de l\'une des premiÃ¨res civilisations' },
{ w:'CANADA', c:'Pays ğŸŒ', h:['2e plus grand pays du monde','Symbole : feuille d\'Ã©rable','Capitale : Ottawa (pas Toronto !)'], d:'Pays d\'AmÃ©rique du Nord' },
{ w:'ISLANDE', c:'Pays ğŸŒ', h:['Ãle volcanique nordique','Aurores borÃ©ales spectaculaires','Capitale : Reykjavik'], d:'Ãle volcanique et glaciÃ¨re du nord' },
],
med: [
{ w:'NAMIBIE', c:'Pays ğŸŒ', h:['DÃ©sert du Namib longe l\'Atlantique','CÃ´te des Squelettes','Parmi les plus faibles densitÃ©s mondiales'], d:'Pays d\'Afrique australe aride' },
{ w:'BHOUTAN', c:'Pays ğŸŒ', h:['Mesure son PIB en Bonheur National Brut','Royaume himalayen bouddhiste','Interdit la publicitÃ© pour le tabac'], d:'Royaume himalayen du bonheur' },
{ w:'GEORGIE', c:'Pays ğŸŒ', h:['Pays du Caucase, entre Europe et Asie','Berceau supposÃ© du vin','Capitale : Tbilissi'], d:'Pays du Caucase aux traditions millÃ©naires' },
],
hard: [
{ w:'LIECHTENSTEIN', c:'Pays ğŸŒ', h:['Seul pays doublement enclavÃ© d\'Europe','Entre Suisse et Autriche','4e pays le plus riche du monde par habitant'], d:'Micro-Ã‰tat europÃ©en doublement enclavÃ©' },
{ w:'VANUATU', c:'Pays ğŸŒ', h:['Archipel du Pacifique Sud','Actif volcanique intense','Capital : Port-Vila'], d:'Nation insulaire du Pacifique' },
]
},
sport: {
easy: [
{ w:'TENNIS', c:'Sport âš½', h:['Se joue avec une raquette','Points : 15, 30, 40, jeu','Wimbledon, Roland-Garros...'], d:'Sport de raquette sur court' },
{ w:'NATATION', c:'Sport âš½', h:['Se pratique dans l\'eau','4 nages officielles','On mesure en longueurs de bassin'], d:'Sport aquatique de dÃ©placement' },
{ w:'BOXE', c:'Sport âš½', h:['On porte des gants en cuir','Ring dÃ©limitÃ© de cordes','K.O. si l\'adversaire reste Ã  terre'], d:'Sport de combat Ã  mains gantÃ©es' },
{ w:'JUDO', c:'Sport âš½', h:['Art martial japonais','On porte un kimono blanc','Objectif : mettre l\'adversaire Ã  terre'], d:'Art martial japonais de projection' },
],
med: [
{ w:'ESCRIME', c:'Sport âš½', h:['Combat avec une Ã©pÃ©e fine','3 armes : fleuret, Ã©pÃ©e, sabre','Masque et tenue blanche'], d:'Sport de combat Ã  l\'Ã©pÃ©e' },
{ w:'CURLING', c:'Sport âš½', h:['Sur la glace, on lance une pierre','Les coÃ©quipiers balaient la glace','AppelÃ© "les Ã©checs sur glace"'], d:'Sport d\'hiver sur glace Ã  la pierre' },
{ w:'BIATHLON', c:'Sport âš½', h:['Ski de fond + tir Ã  la carabine','Sport olympique d\'hiver','PÃ©nalitÃ© si on rate une cible'], d:'Sport combinant ski nordique et tir' },
],
hard: [
{ w:'SEPAKTAKRAW', c:'Sport âš½', h:['Asie du Sud-Est','Balle en rotin','Comme le volley mais uniquement avec les pieds'], d:'Sport collectif asiatique au pied' },
{ w:'KABADDI', c:'Sport âš½', h:['Sport national du Bangladesh et Inde','Un attaquant retient sa respiration en rÃ©pÃ©tant "kabaddi"','Contact physique et stratÃ©gie'], d:'Sport de contact sud-asiatique' },
]
},
objet: {
easy: [
{ w:'LUNETTES', c:'Objet ğŸ”§', h:['Se portent sur le nez','Corrigent la vue ou protÃ¨gent du soleil','Deux verres et une monture'], d:'Optique correctrice portÃ©e sur le visage' },
{ w:'PARAPLUIE', c:'Objet ğŸ”§', h:['ProtÃ¨ge de la pluie','S\'ouvre et se referme','Toile impermÃ©able sur une armature'], d:'Dispositif de protection contre la pluie' },
{ w:'HORLOGE', c:'Objet ğŸ”§', h:['Mesure et affiche le temps','AccrochÃ©e au mur ou posÃ©e','Tic-tac Ã  chaque seconde'], d:'Instrument de mesure du temps' },
{ w:'TELESCOPE', c:'Objet ğŸ”§', h:['Instrument optique grossissant','Observe les Ã©toiles et planÃ¨tes','GalilÃ©e l\'a popularisÃ©'], d:'Instrument d\'observation astronomique' },
],
med: [
{ w:'SEXTANT', c:'Objet ğŸ”§', h:['Navigation maritime ancienne','Mesure l\'angle entre deux objets','Indispensable avant le GPS'], d:'Instrument de navigation maritime' },
{ w:'ALAMBIC', c:'Objet ğŸ”§', h:['Sert Ã  distiller des liquides','Fabrication d\'alcools artisanaux','Col de cygne et ballon de verre'], d:'Appareil de distillation' },
{ w:'METRONOME', c:'Objet ğŸ”§', h:['Rythme rÃ©gulier pour musiciens','Balancier qui va et vient','Bip ou tic-tac au tempo choisi'], d:'Appareil Ã  tempo pour musiciens' },
],
hard: [
{ w:'HYGROMETRE', c:'Objet ğŸ”§', h:['Mesure l\'humiditÃ© de l\'air','Cave Ã  vin, serreâ€¦','LiÃ© Ã  la mÃ©tÃ©orologie et conservation'], d:'Instrument de mesure d\'humiditÃ© atmosphÃ©rique' },
{ w:'GALVANOMETRE',c:'Objet ğŸ”§', h:['DÃ©tecte et mesure courants Ã©lectriques faibles','NommÃ© d\'aprÃ¨s Luigi Galvani','Aiguille dÃ©viÃ©e par le courant'], d:'Instrument de mesure de courant Ã©lectrique' },
]
},
food: {
easy: [
{ w:'SUSHI', c:'Nourriture ğŸ•', h:['Plat japonais emblÃ©matique','Riz vinaigrÃ© + poisson ou lÃ©gumes','Se mange avec des baguettes'], d:'Plat japonais Ã  base de riz vinaigrÃ©' },
{ w:'PIZZA', c:'Nourriture ğŸ•', h:['Plat italien rond cuit au four','PÃ¢te + sauce tomate + fromage','Se dÃ©coupe en parts triangulaires'], d:'Plat italien sur pÃ¢te levÃ©e' },
{ w:'CROISSANT', c:'Nourriture ğŸ•', h:['Viennoiserie franÃ§aise dorÃ©e','Forme de croissant de lune','Au beurre, il est feuilletÃ©'], d:'Viennoiserie feuilletÃ©e au beurre' },
{ w:'RATATOUILLE',c:'Nourriture ğŸ•', h:['Plat vÃ©gÃ©tarien provenÃ§al','LÃ©gumes du soleil mijotÃ©s','Un film Pixar porte ce nom'], d:'Plat de lÃ©gumes mÃ©diterranÃ©ens cuits' },
],
med: [
{ w:'BOUILLABAISSE',c:'Nourriture ğŸ•',h:['Soupe de poissons provenÃ§ale','SpÃ©cialitÃ© de Marseille','AccompagnÃ©e de rouille et croÃ»tons'], d:'Soupe de poisson marseillaise' },
{ w:'TIRAMISU', c:'Nourriture ğŸ•',h:['Dessert italien au cafÃ©','Signifie "tire-moi vers le haut"','Mascarpone, biscuits, cacao'], d:'Dessert crÃ©meux italien' },
{ w:'KIMCHI', c:'Nourriture ğŸ•',h:['Fermentation corÃ©enne','Chou, piment, ail','ConsidÃ©rÃ© superfood probiotique'], d:'LÃ©gumes fermentÃ©s Ã©picÃ©s corÃ©ens' },
],
hard: [
{ w:'SURSTROMING',c:'Nourriture ğŸ•', h:['Hareng fermentÃ© suÃ©dois','Odeur considÃ©rÃ©e parmi les plus fortes du monde','Interdit d\'ouverture en intÃ©rieur'], d:'Poisson fermentÃ© suÃ©dois trÃ¨s odorant' },
{ w:'BRIGADEIRO', c:'Nourriture ğŸ•', h:['Confiserie brÃ©silienne','Lait condensÃ© sucrÃ© + cacao','Recouvert de vermicelles en chocolat'], d:'Bonbon brÃ©silien au chocolat' },
]
},
science: {
easy: [
{ w:'ATOME', c:'Science ğŸ”¬', h:['Brique de base de la matiÃ¨re','Contient protons, neutrons et Ã©lectrons','Trop petit pour Ãªtre vu'], d:'UnitÃ© de base de la matiÃ¨re' },
{ w:'GALAXIE', c:'Science ğŸ”¬', h:['Milliards d\'Ã©toiles regroupÃ©es','La nÃ´tre : Voie lactÃ©e','Peuvent Ãªtre spirales, elliptiquesâ€¦'], d:'Vaste systÃ¨me d\'Ã©toiles dans l\'univers' },
{ w:'CHROMOSOME',c:'Science ğŸ”¬', h:['Porteur d\'information gÃ©nÃ©tique','L\'humain en a 46 (23 paires)','Contient l\'ADN'], d:'Structure portant les gÃ¨nes' },
],
med: [
{ w:'QUASAR', c:'Science ğŸ”¬', h:['Noyau de galaxie trÃ¨s actif','Parmi les objets les plus lumineux de l\'univers','AlimentÃ© par un trou noir supermassif'], d:'Noyau galactique actif extrÃªmement lumineux' },
{ w:'MITOCHONDRIE',c:'Science ğŸ”¬',h:['Organite cellulaire','Centrale Ã©nergÃ©tique de la cellule','"La puissance centrale de la cellule"'], d:'Organite producteur d\'Ã©nergie cellulaire' },
{ w:'PHOTOSYNTHESE',c:'Science ğŸ”¬',h:['Processus des plantes vertes','LumiÃ¨re + CO2 + eau â†’ sucres + O2','Chlorophylle indispensable'], d:'Processus de conversion de la lumiÃ¨re en Ã©nergie' },
],
hard: [
{ w:'DECOHERENCE', c:'Science ğŸ”¬',h:['PhÃ©nomÃ¨ne quantique','Perte des propriÃ©tÃ©s quantiques au contact de l\'environnement','Explique le monde macroscopique'], d:'Perte des effets quantiques par interaction' },
{ w:'BIOLUMINESCENCE',c:'Science ğŸ”¬',h:['LumiÃ¨re produite par des Ãªtres vivants','Lucioles, certains poissons, mÃ©duses','RÃ©action chimique sans chaleur'], d:'Production naturelle de lumiÃ¨re par les Ãªtres vivants' },
]
},
celeb: {
easy: [
{ w:'EINSTEIN', c:'PersonnalitÃ© ğŸ¬', h:['Physicien du XXe siÃ¨cle','ThÃ©orie de la relativitÃ©','E = mcÂ² - l\'Ã©quation la plus cÃ©lÃ¨bre'], d:'Physicien thÃ©oricien rÃ©volutionnaire' },
{ w:'MOZART', c:'PersonnalitÃ© ğŸ¬', h:['Compositeur prodige autrichien','CommencÃ© Ã  composer Ã  5 ans','Requiem inachevÃ© Ã  sa mort'], d:'Compositeur classique autrichien' },
{ w:'NAPOLEON', c:'PersonnalitÃ© ğŸ¬', h:['Pas si petit qu\'on le dit','GÃ©nÃ©ral puis Empereur des FranÃ§ais','ExilÃ© Ã  Sainte-HÃ©lÃ¨ne en 1815'], d:'GÃ©nÃ©ral et Empereur des FranÃ§ais' },
],
med: [
{ w:'TESLA', c:'PersonnalitÃ© ğŸ¬', h:['Inventeur serbo-amÃ©ricain','Pionnier du courant alternatif','Grand rival d\'Edison'], d:'Inventeur et pionnier de l\'Ã©lectricitÃ©' },
{ w:'CURIE', c:'PersonnalitÃ© ğŸ¬', h:['PremiÃ¨re femme Ã  recevoir un Prix Nobel','MÃªme deux Nobel : physique et chimie','RadioactivitÃ©'], d:'PionniÃ¨re de la radioactivitÃ©' },
{ w:'TURING', c:'PersonnalitÃ© ğŸ¬', h:['PÃ¨re de l\'informatique','Cassa le code Enigma pendant WWII','Son test Ã©value l\'IA'], d:'MathÃ©maticien fondateur de l\'informatique' },
],
hard: [
{ w:'LOVELACE', c:'PersonnalitÃ© ğŸ¬', h:['Fille de Lord Byron','PremiÃ¨re programmeuse de l\'histoire','A travaillÃ© sur la machine analytique de Babbage'], d:'PremiÃ¨re programmeuse de l\'histoire' },
{ w:'FIBONACCI', c:'PersonnalitÃ© ğŸ¬', h:['MathÃ©maticien mÃ©diÃ©val italien','Sa suite : 0,1,1,2,3,5,8,13â€¦','A popularisÃ© les chiffres arabes en Europe'], d:'MathÃ©maticien mÃ©diÃ©val, inventeur de la suite cÃ©lÃ¨bre' },
]
}
};

function buildMix() {
const mix = { easy:[], med:[], hard:[] };
Object.keys(WORDS).forEach(cat => {
['easy','med','hard'].forEach(d => {
if (WORDS[cat][d]) mix[d].push(...WORDS[cat][d]);
});
});
WORDS.mix = mix;
}
buildMix();

function pickWord(cat, diff) {
const pool = WORDS[cat]?.[diff] || WORDS.mix[diff] || WORDS.mix.easy;
return pool[Math.floor(Math.random() * pool.length)];
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 4. Ã‰TAT GLOBAL
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
const myId = sessionStorage.getItem('lexis_uid') || Math.random().toString(36).slice(2,11);
sessionStorage.setItem('lexis_uid', myId);

let myName = '';
let roomCode = '', roomRef = null, unsub = null;
let selDiff = 'easy', selCat = 'mix';
let godMode = false, soundOn = true, speedMode = false;
let timerInterval = null, hintBarInterval = null, hintPushInterval = null;
let timerMax = 120, timerLeft = 0;
let lastHintCount = 0, endHandled = false;

const GOD_CODE = 'LEXIS2026';

let stats = JSON.parse(localStorage.getItem('lexis_stats') || '{"wins":0,"played":0,"streak":0}');
function saveStats() { localStorage.setItem('lexis_stats', JSON.stringify(stats)); }

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 5. UTILS
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function genCode() {
const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789';
return Array.from({length:4}, () => chars[Math.floor(Math.random()*chars.length)]).join('');
}

let toastT;
function toast(msg, type = 'if', dur = 2800) {
const el = document.getElementById('toast');
el.textContent = msg;
el.className = 'up ' + type;
clearTimeout(toastT);
toastT = setTimeout(() => el.classList.remove('up'), dur);
}

function shk(id) {
const el = document.getElementById(id);
if (!el) return;
el.classList.add('shk');
setTimeout(() => el.classList.remove('shk'), 450);
}

function copyCode() {
if (navigator.clipboard) {
navigator.clipboard.writeText(roomCode).then(() => toast('ğŸ“‹ Code copiÃ© !', 'ok')).catch(() => toast('Code : '+roomCode, 'if'));
} else toast('Code : '+roomCode, 'if');
}

function lev(a, b) {
const m = a.length, n = b.length;
const dp = Array.from({length:m+1}, (_, i) => Array.from({length:n+1}, (_, j) => i===0?j:j===0?i:0));
for (let i=1;i<=m;i++) for (let j=1;j<=n;j++)
dp[i][j] = a[i-1]===b[j-1] ? dp[i-1][j-1] : 1+Math.min(dp[i-1][j], dp[i][j-1], dp[i-1][j-1]);
return dp[m][n];
}

function playSound(type) {
if (!soundOn) return;
try {
const ctx = new (window.AudioContext||window.webkitAudioContext)();
const osc = ctx.createOscillator();
const gain = ctx.createGain();
osc.connect(gain); gain.connect(ctx.destination);
if (type === 'win') {
[523,659,784,1047].forEach((f, i) => {
osc.frequency.setValueAtTime(f, ctx.currentTime + i*.12);
});
gain.gain.setValueAtTime(.3, ctx.currentTime);
gain.gain.exponentialRampToValueAtTime(.001, ctx.currentTime+.8);
osc.start(ctx.currentTime); osc.stop(ctx.currentTime+.8);
} else if (type === 'miss') {
osc.frequency.setValueAtTime(180, ctx.currentTime);
gain.gain.setValueAtTime(.2, ctx.currentTime);
gain.gain.exponentialRampToValueAtTime(.001, ctx.currentTime+.3);
osc.start(); osc.stop(ctx.currentTime+.3);
} else if (type === 'hint') {
osc.frequency.setValueAtTime(880, ctx.currentTime);
osc.frequency.setValueAtTime(1100, ctx.currentTime+.1);
gain.gain.setValueAtTime(.12, ctx.currentTime);
gain.gain.exponentialRampToValueAtTime(.001, ctx.currentTime+.25);
osc.start(); osc.stop(ctx.currentTime+.25);
}
} catch(e) {}
}

function confetti() {
const cols = ['#833AB4','#E1306C','#F77737','#ffd700','#19d364'];
for (let i=0; i<90; i++) {
const el = document.createElement('div');
const sz = 5 + Math.random()*12;
el.style.cssText = `position:fixed;left:${Math.random()*100}vw;top:-20px;width:${sz}px;height:${sz}px;background:${cols[Math.floor(Math.random()*cols.length)]};border-radius:${Math.random()>.5?'50%':'3px'};animation:confPop ${2+Math.random()*3}s ${Math.random()*1.5}s linear forwards;z-index:9999;pointer-events:none;`;
document.body.appendChild(el);
setTimeout(() => el.remove(), 5500);
}
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 6. NAVIGATION
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function go(id) {
document.querySelectorAll('.sc').forEach(s => s.classList.remove('on'));
document.getElementById(id)?.classList.add('on');
const inGame = ['s-create','s-join','s-lobby','s-game','s-end'].includes(id);
document.getElementById('back-btn').classList.toggle('vis', inGame);
}

function goHome() {
stopAllTimers(); leaveRoom(); go('s-home');
updateHomeStats();
}

function leaveRoom() {
if (unsub) { unsub(); unsub = null; }
roomRef = null; roomCode = '';
endHandled = false;
document.getElementById('win-overlay').classList.remove('on');
}

function stopAllTimers() {
clearInterval(timerInterval);
clearInterval(hintBarInterval);
clearInterval(hintPushInterval);
}

function updateHomeStats() {
document.getElementById('h-wins').textContent = stats.wins;
document.getElementById('h-played').textContent = stats.played;
document.getElementById('h-streak').textContent = stats.streak + 'ğŸ”¥';
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 7. CRÃ‰ER UNE PARTIE
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function createGame() {
const name = document.getElementById('c-name').value.trim();
if (!name) { toast('Entre ton pseudo !', 'er'); shk('c-name'); return; }

const code = genCode();
const speed = document.getElementById('speed-chk').checked;
const wordObj = pickWord(selCat, selDiff);
myName = name; roomCode = code;

const data = {
code, hostId:myId, status:'lobby',
category:selCat, difficulty:selDiff, speedMode:speed,
word: wordObj.w,
meta: { cat:wordObj.c, hints:wordObj.h, def:wordObj.d },
hints: [],
guesses:{},
scores: {},
winner: null,
startedAt: null,
hintPushedAt: null,
players:{},
createdAt: Date.now()
};
data.players[myId] = { id:myId, name, av:0, joinedAt:Date.now() };
data.scores[myId] = 0;

whenFB(() => {
db.ref('lexis/'+code).set(data)
.then(() => { attachListener(code); go('s-lobby'); toast('Partie crÃ©Ã©e ! Code : '+code, 'ok', 4000); })
.catch(e => toast('Erreur Firebase : '+e.message, 'er'));
});
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 8. REJOINDRE
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function joinGame() {
const name = document.getElementById('j-name').value.trim();
const code = document.getElementById('j-code').value.trim().toUpperCase();
if (!name) { toast('Entre ton pseudo !', 'er'); shk('j-name'); return; }
if (code.length !== 4) { toast('Code Ã  4 caractÃ¨res !', 'er'); shk('j-code'); return; }

whenFB(() => {
db.ref('lexis/'+code).get().then(snap => {
if (!snap.exists()) { toast('Code invalide !', 'er'); shk('j-code'); return; }
const room = snap.val();
if (room.status !== 'lobby') { toast('Partie dÃ©jÃ  commencÃ©e !', 'er'); return; }
if (Object.keys(room.players||{}).length >= 2) { toast('Partie complÃ¨te !', 'er'); return; }
myName = name; roomCode = code;
speedMode = room.speedMode;
const upd = {};
upd[`players/${myId}`] = { id:myId, name, av:1, joinedAt:Date.now() };
upd[`scores/${myId}`] = 0;
db.ref('lexis/'+code).update(upd)
.then(() => { attachListener(code); go('s-lobby'); toast('ConnectÃ© ! Bienvenue '+name+' ğŸ‘‹', 'ok'); })
.catch(e => toast('Erreur : '+e.message, 'er'));
}).catch(e => toast('Erreur : '+e.message, 'er'));
});
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 9. LISTENER FIREBASE
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function attachListener(code) {
if (unsub) unsub();
roomRef = db.ref('lexis/'+code);
roomRef.on('value', snap => {
if (!snap.exists()) return;
const room = snap.val();
const cur = document.querySelector('.sc.on')?.id || '';

switch (room.status) {
case 'lobby': renderLobby(room); break;
case 'playing':
if (cur === 's-lobby') { go('s-game'); initGame(room); }
renderGame(room);
break;
case 'ended': handleEnd(room); break;
}
});
unsub = () => roomRef.off('value');
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 10. LOBBY
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function renderLobby(room) {
document.getElementById('l-code').textContent = room.code;
const players = Object.values(room.players||{}).sort((a,b)=>a.joinedAt-b.joinedAt);
const listEl = document.getElementById('l-players');
listEl.innerHTML = '';

const avCls = ['av-1','av-2'];
const avEmoj = ['ğŸ˜','ğŸ¦Š'];
players.forEach((p, i) => {
const isMe = p.id === myId;
const div = document.createElement('div');
div.className = 'p-card' + (isMe?' me':' ready');
div.innerHTML = `<div class="p-av ${avCls[i]}">${avEmoj[i]}</div><div class="p-name">${p.name}</div><div class="p-status" style="color:${isMe?'#E1306C':'#19d364'}">${isMe?'Toi âœ¦':'ConnectÃ© âœ“'}</div>`;
listEl.appendChild(div);
});
if (players.length < 2) {
const empty = document.createElement('div');
empty.className = 'p-card';
empty.innerHTML = '<div class="p-av av-e">â³</div><div class="p-name" style="color:var(--txt2)">En attente...</div><div class="p-status">Partage le code !</div>';
listEl.appendChild(empty);
}

const cnt = players.length;
const isHost = room.hostId === myId;
const canStart = cnt >= 2;

document.getElementById('l-status-txt').textContent = canStart
? `âœ… ${cnt} joueurs prÃªts !`
: 'â³ En attente du 2Ã¨me joueur...';
document.getElementById('l-wait').style.display = canStart ? 'none' : 'flex';
document.getElementById('l-start').style.display = (isHost && canStart) ? 'flex' : 'none';

const catNames = {mix:'Tout mÃ©langer',animal:'Animaux',pays:'Pays',sport:'Sports',objet:'Objets',food:'Nourriture',science:'Science',celeb:'PersonnalitÃ©s'};
const diffNames= {easy:'ğŸ˜Š Facile',med:'ğŸ”¥ Moyen',hard:'ğŸ’€ Difficile'};
document.getElementById('l-info').innerHTML =
`${catNames[room.category]||room.category} * ${diffNames[room.difficulty]||room.difficulty}` +
(room.speedMode ? ' * <strong style="color:#F77737">âš¡ Mode rapide</strong>' : '');
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 11. LANCER
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function startGame() {
whenFB(() => {
db.ref('lexis/'+roomCode).get().then(snap => {
const room = snap.val();
if (!room || Object.keys(room.players||{}).length < 2) { toast('Il faut 2 joueurs !', 'er'); return; }
db.ref('lexis/'+roomCode).update({
status:'playing', startedAt:Date.now(), hintPushedAt:Date.now(), updatedAt:Date.now()
});
});
});
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 12. INIT JEU
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function initGame(room) {
stopAllTimers();
endHandled = false; lastHintCount = 0;
speedMode = room.speedMode; timerMax = 120;
const elapsed = Math.floor((Date.now() - room.startedAt) / 1000);
timerLeft = Math.max(0, timerMax - elapsed);
startTimer(room);
if (room.hostId === myId) startHintPush(room);
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 13. TIMER
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function startTimer(room) {
clearInterval(timerInterval);
updateTimer(timerLeft);
timerInterval = setInterval(() => {
timerLeft--;
updateTimer(timerLeft);
if (timerLeft <= 0) {
clearInterval(timerInterval);
if (room.hostId === myId) db.ref('lexis/'+roomCode).update({ status:'ended', updatedAt:Date.now() });
}
}, 1000);
}

function updateTimer(t) {
const arc = document.getElementById('t-arc');
const num = document.getElementById('t-num');
const disp = document.getElementById('t-display');
if (!arc || !num) return;
const pct = t / timerMax;
arc.style.strokeDashoffset = 138 * (1 - pct);
const col = t > timerMax*.5 ? '#E1306C' : t > timerMax*.25 ? '#F77737' : '#833AB4';
arc.style.stroke = col;
num.textContent = t;
num.style.color = col;
if (disp) {
const m = Math.floor(t/60), s = t%60;
disp.textContent = `${m}:${s<10?'0':''}${s}`;
}
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 14. INDICES
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function startHintPush(room) {
clearInterval(hintPushInterval);
const interval = (room.speedMode ? 10 : 20) * 1000;
pushNextHint();
hintPushInterval = setInterval(pushNextHint, interval);
}

function pushNextHint() {
whenFB(() => {
db.ref('lexis/'+roomCode).get().then(snap => {
if (!snap.exists()) return;
const room = snap.val();
if (room.status !== 'playing') { clearInterval(hintPushInterval); return; }

const hints = room.hints || [];
const meta = room.meta;
const maxHints = (meta.hints?.length || 0) + 2;
if (hints.length >= maxHints) return;

let next;
if (hints.length === 0) next = `CatÃ©gorie : ${meta.cat}`;
else if (hints.length === 1) next = `PremiÃ¨re lettre : ${room.word[0]}`;
else {
const idx = hints.length - 2;
next = meta.hints?.[idx] ? meta.hints[idx] : `DÃ©finition : ${meta.def}`;
}

hints.push(next);
db.ref('lexis/'+roomCode).update({ hints, hintPushedAt:Date.now(), updatedAt:Date.now() });
});
});
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 15. RENDU JEU
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function renderGame(room) {
renderBlanks(room); renderHints(room); renderGuesses(room); renderHintBar(room); updateGodPeek(room);

const hints = room.hints || [];
if (hints.length > lastHintCount) { lastHintCount = hints.length; playSound('hint'); }

const pts = Math.max(10, 100 - (hints.length * 15));
document.getElementById('g-pts').textContent = `â­ ${pts} pts`;

const foundMe = room.guesses?.[myId]?.correct;
document.getElementById('g-input-zone').style.display = foundMe ? 'none' : 'block';
document.getElementById('g-found').classList.toggle('on', !!foundMe);

const maxH = (room.meta?.hints?.length || 3) + 2;
document.getElementById('g-prog').style.width = (hints.length / maxH * 100) + '%';
}

function renderBlanks(room) {
const word = room.word || '';
const hints = room.hints || [];
const blankEl = document.getElementById('g-blanks');
blankEl.innerHTML = '';

const revealed = new Set();
if (hints.length >= 2) {
const n = Math.floor(hints.length / 2);
for (let i = 0; i < Math.min(n, word.length-1); i++) revealed.add(i);
}

for (let i = 0; i < word.length; i++) {
const sp = document.createElement('span');
if (word[i] === ' ') { sp.className = 'blank sp'; }
else {
sp.className = 'blank' + (revealed.has(i) ? ' lit' : '');
sp.textContent = revealed.has(i) ? word[i] : '';
}
blankEl.appendChild(sp);
}

const realLen = word.replace(/ /g, '').length;
document.getElementById('g-word-meta').textContent = `${realLen} lettre${realLen>1?'s':''}${word.includes(' ')?' * Plusieurs mots':''}`;
document.getElementById('g-cat').textContent = room.meta?.cat || room.category;
}

function renderHints(room) {
const hints = room.hints || [];
const hEl = document.getElementById('g-hints');
hEl.innerHTML = '';
document.getElementById('g-hint-n').textContent = hints.length ? `${hints.length} indice${hints.length>1?'s':''}` : '';

if (!hints.length) {
hEl.innerHTML = '<div class="no-hint">â³ Premier indice dans quelques secondes...</div>';
return;
}
const icons = ['ğŸ·ï¸','ğŸ”¤','ğŸ“–','ğŸ’¡','ğŸŒŸ','ğŸ¯','ğŸ”','âœ¨'];
const labels = ['CatÃ©gorie','Lettre initiale','Indice 1','Indice 2','Indice 3','Indice 4','Bonus','Final'];
hints.forEach((h, i) => {
const div = document.createElement('div');
div.className = 'hint-item';
div.innerHTML = `<div class="hint-icon">${icons[i]||'ğŸ’¡'}</div><div><div class="hint-label">${labels[i]||'Indice'}</div><div class="hint-text">${h}</div></div>`;
hEl.appendChild(div);
});
}

function renderGuesses(room) {
const guesses = room.guesses || {};
const players = room.players || {};
const feed = document.getElementById('g-feed');
feed.innerHTML = '';

const list = Object.entries(guesses)
.filter(([,v]) => v && typeof v === 'object')
.map(([pid, v]) => ({ name:(players[pid]?.name||'?'), ...v }))
.sort((a,b) => (a.at||0)-(b.at||0));

if (!list.length) {
feed.innerHTML = '<div style="padding:14px;text-align:center;font-size:12px;color:var(--txt2);">Aucune tentative pour l\'instant</div>';
return;
}
list.forEach(g => {
const div = document.createElement('div');
div.className = 'g-item' + (g.correct?' g-win':g.close?' g-close':'');
div.innerHTML = `<span class="g-who">${g.name}</span><span class="g-word">${g.word}</span><span class="g-icon">${g.correct?'âœ…':g.close?'ğŸŸ¡':'âŒ'}</span>`;
feed.appendChild(div);
});
document.getElementById('g-att-n').textContent = `${list.length} tentative${list.length>1?'s':''}`;
}

function renderHintBar(room) {
const bar = document.getElementById('g-hint-bar');
const hints= room.hints || [];
const maxH = (room.meta?.hints?.length || 3) + 2;
if (hints.length >= maxH) { bar.style.display='none'; return; }
bar.style.display = 'flex';

const interval = (room.speedMode ? 10 : 20) * 1000;
clearInterval(hintBarInterval);
const update = () => {
const elapsed = Date.now() - (room.hintPushedAt || room.startedAt);
const pct = Math.min(100, (elapsed / interval) * 100);
const remain = Math.max(0, Math.ceil((interval - elapsed) / 1000));
document.getElementById('g-bar-fill').style.width = pct + '%';
document.getElementById('g-bar-txt').textContent = `Prochain indice dans ${remain}s`;
};
update();
hintBarInterval = setInterval(update, 500);
}

function updateGodPeek(room) {
const el = document.getElementById('god-peek');
if (!el) return;
if (godMode) { el.textContent = 'âš¡ ' + room.word; el.classList.add('on'); }
else el.classList.remove('on');
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 16. DEVINER
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function submitGuess() {
const inpEl = document.getElementById('g-inp');
const guess = inpEl.value.trim().toUpperCase();
if (!guess) { toast('Entre un mot !', 'er'); shk('g-inp'); return; }
inpEl.value = '';

whenFB(() => {
db.ref('lexis/'+roomCode).get().then(snap => {
const room = snap.val();
if (!room || room.status !== 'playing') return;
if (room.guesses?.[myId]?.correct) { toast('Tu as dÃ©jÃ  trouvÃ© ! ğŸ˜Š', 'if'); return; }

const target = room.word.toUpperCase();
const correct = guess === target;
const close = !correct && lev(guess, target) <= 2;
const pts = Math.max(10, 100 - ((room.hints||[]).length * 15));

const upd = {};
upd[`guesses/${myId}`] = { word:guess, correct, close, at:Date.now() };
upd.updatedAt = Date.now();

if (correct) {
upd[`scores/${myId}`] = ((room.scores?.[myId]) || 0) + pts;
upd.winner = myId;
upd.status = 'ended';
toast(`ğŸ‰ BRAVO ! +${pts} pts !`, 'gd', 4000);
playSound('win'); confetti();
} else if (close) {
toast(`ğŸŸ¡ Tout prÃ¨s ! (${lev(guess,target)} lettre${lev(guess,target)>1?'s':''} d'Ã©cart)`, 'if');
playSound('miss');
} else {
toast('âŒ Ce n\'est pas Ã§a...', 'er', 1500);
playSound('miss');
}

db.ref('lexis/'+roomCode).update(upd);
});
});
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 17. FIN DE PARTIE
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function handleEnd(room) {
if (endHandled) return;
endHandled = true;
stopAllTimers();

const isWinner = room.winner === myId;
const winPlayer = room.players?.[room.winner];

stats.played++;
if (isWinner) { stats.wins++; stats.streak++; } else { stats.streak = 0; }
saveStats();

document.getElementById('we').textContent = isWinner ? 'ğŸ†' : room.winner ? 'ğŸ’”' : 'â°';
document.getElementById('wt').textContent = isWinner ? 'Tu as gagnÃ© !' : room.winner ? 'Perdu !' : 'Temps Ã©coulÃ© !';
document.getElementById('ws').textContent = isWinner
? `Bravo ${myName} ! Tu as trouvÃ© "${room.word}" en premier !`
: room.winner
? `${winPlayer?.name||'L\'adversaire'} a trouvÃ© avant toi. Le mot Ã©tait "${room.word}".`
: `Personne n'a trouvÃ© "${room.word}". Retente ta chance !`;
document.getElementById('ww').textContent = room.word;
document.getElementById('win-overlay').classList.add('on');

if (isWinner) { playSound('win'); confetti(); }
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 18. REJOUER
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function replay() {
document.getElementById('win-overlay').classList.remove('on');
whenFB(() => {
db.ref('lexis/'+roomCode).get().then(snap => {
if (!snap.exists()) { goHome(); return; }
const room = snap.val();
if (room.hostId !== myId) { toast('L\'hÃ´te va relancer...', 'if'); return; }
const wordObj = pickWord(room.category, room.difficulty);
db.ref('lexis/'+roomCode).update({
status:'lobby', word:wordObj.w, meta:{cat:wordObj.c,hints:wordObj.h,def:wordObj.d},
hints:[], guesses:{}, winner:null, startedAt:null, hintPushedAt:null
}).then(() => { endHandled=false; go('s-lobby'); });
});
});
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 19. GOD MODE
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
function checkGodCode(val) {
const msg = document.getElementById('god-msg');
if (val.toUpperCase() === GOD_CODE) {
godMode = true;
msg.textContent = 'âš¡ Mode CrÃ©ateur activÃ© ! Tu vois le mot.';
msg.className = 'god-msg ok';
toast('âš¡ MODE CRÃ‰ATEUR ACTIVÃ‰ !', 'gd', 3000);
if (roomCode) whenFB(() => db.ref('lexis/'+roomCode).get().then(s => { if(s.exists()) updateGodPeek(s.val()); }));
} else if (val.length >= GOD_CODE.length) {
godMode = false;
msg.textContent = 'âŒ Code incorrect.';
msg.className = 'god-msg er';
document.getElementById('god-peek')?.classList.remove('on');
} else {
msg.className = 'god-msg';
godMode = false;
document.getElementById('god-peek')?.classList.remove('on');
}
}

// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
// 20. DOM READY
// â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
document.addEventListener('DOMContentLoaded', () => {

setTimeout(() => document.getElementById('loader').classList.add('out'), 1500);

document.getElementById('theme-btn').textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
document.getElementById('dark-chk').checked = isDark;
document.getElementById('theme-btn').addEventListener('click', () => applyTheme(!isDark));
document.getElementById('dark-chk').addEventListener('change', e => applyTheme(e.target.checked));

document.getElementById('settings-btn').addEventListener('click', () => {
document.getElementById('drawer').classList.add('open');
document.getElementById('dmask').classList.add('on');
});
document.getElementById('dmask').addEventListener('click', () => {
document.getElementById('drawer').classList.remove('open');
document.getElementById('dmask').classList.remove('on');
});

document.getElementById('god-inp').addEventListener('input', e => checkGodCode(e.target.value));
document.getElementById('sound-chk').addEventListener('change', e => soundOn = e.target.checked);

updateHomeStats();

document.getElementById('back-btn').addEventListener('click', goHome);
document.getElementById('btn-go-create').addEventListener('click', () => go('s-create'));
document.getElementById('btn-go-join').addEventListener('click', () => go('s-join'));

document.querySelectorAll('.diff-pill').forEach(pill => {
pill.addEventListener('click', () => {
document.querySelectorAll('.diff-pill').forEach(p => p.className = 'diff-pill');
const d = pill.dataset.d;
pill.classList.add('sel-' + (d==='easy'?'e':d==='med'?'m':'h'));
selDiff = d;
});
});
document.querySelector('.diff-pill[data-d="easy"]').classList.add('sel-e');

document.getElementById('btn-create-ok').addEventListener('click', createGame);
document.getElementById('btn-create-back').addEventListener('click', () => go('s-home'));
document.getElementById('c-cat').addEventListener('change', e => selCat = e.target.value);

document.getElementById('btn-join-ok').addEventListener('click', joinGame);
document.getElementById('btn-join-back').addEventListener('click', () => go('s-home'));
const jc = document.getElementById('j-code');
jc.addEventListener('input', () => { jc.value = jc.value.toUpperCase().replace(/[^A-Z0-9]/g, ''); });
jc.addEventListener('keydown', e => { if (e.key==='Enter') joinGame(); });

document.getElementById('l-start').addEventListener('click', startGame);
document.getElementById('l-copy').addEventListener('click', copyCode);

const gInp = document.getElementById('g-inp');
gInp.addEventListener('input', () => { gInp.value = gInp.value.toUpperCase(); });
gInp.addEventListener('keydown', e => { if (e.key==='Enter') submitGuess(); });
document.getElementById('g-send').addEventListener('click', submitGuess);

document.getElementById('btn-replay').addEventListener('click', replay);
document.getElementById('btn-quit-w').addEventListener('click', goHome);
document.getElementById('btn-end-replay').addEventListener('click', replay);
document.getElementById('btn-end-home').addEventListener('click', goHome);

});
</script>

</body>
</html>